<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Moldflow Help Desk - 사출 성형 공정 관리</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root{--primary:#1a5f7a;--primary-dark:#0d3d52;--primary-light:#2d8bb8;--accent:#ff6b35;--accent-light:#ff8c5a;--success:#28a745;--warning:#ffc107;--danger:#dc3545;--bg-dark:#0f1419;--bg-card:#1a2332;--bg-input:#232d3f;--text-primary:#e8edf3;--text-secondary:#8899aa;--border:#2d3d52}
        /* 라이트 모드(밝은 배경) 변수 오버라이드 */
        body.light-mode{
            --bg-dark:#ffffff;
            --bg-card:#f7f9fc;
            --bg-input:#ffffff;
            --text-primary:#111827;
            --text-secondary:#4b5563;
            --border:#d1d5db;
        }
        body.light-mode #login-overlay{
            background: linear-gradient(135deg, #ffffff 0%, #f3f4f6 100%);
        }

        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Noto Sans KR',sans-serif;background:var(--bg-dark);color:var(--text-primary);min-height:100vh;line-height:1.6; overflow-x: hidden;} /* 로그인 전 스크롤 방지 */
        
        /* --- 로그인 오버레이 스타일 추가 --- */
        #login-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, var(--bg-dark) 0%, #080a0d 100%);
            z-index: 9999; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            transition: opacity 0.5s ease;
        }
        .login-card {
            background: var(--bg-card); padding: 3rem; border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5); border: 1px solid var(--border);
            text-align: center; max-width: 400px; width: 90%;
        }
        .login-logo {
            width: 70px; height: 70px; background: var(--accent);
            border-radius: 16px; margin: 0 auto 1.5rem;
            display: flex; align-items: center; justify-content: center;
            font-size: 2rem; font-weight: 700; color: white;
        }
        .login-input {
            width: 100%; padding: 1rem; margin: 1.5rem 0;
            background: var(--bg-input); border: 1px solid var(--border);
            border-radius: 8px; color: var(--text-primary); font-size: 1.1rem; text-align: center;
        }
        .login-input:focus { outline: none; border-color: var(--accent); }
        .login-btn {
            width: 100%; padding: 1rem; background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            border: none; border-radius: 8px; color: white; font-size: 1.1rem; font-weight: 600;
            cursor: pointer; transition: transform 0.2s;
        }
        .login-btn:hover { transform: translateY(-2px); }
        .login-footer { margin-top: 1.5rem; font-size: 0.8rem; color: var(--text-secondary); }
        .error-msg { color: var(--danger); margin-top: 1rem; font-size: 0.9rem; display: none; }
        
        /* 기존 스타일 유지 */
        header{background:linear-gradient(135deg,#1a5f7a 0%,#2d8bb8 100%);padding:1.5rem 2rem;position:sticky;top:0;z-index:1000;box-shadow:0 4px 20px rgba(0,0,0,0.3)}
        .header-content{max-width:1600px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}
        .logo{display:flex;align-items:center;gap:1rem}
        .logo-icon{width:50px;height:50px;background:var(--accent);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;font-weight:700;color:white}
        .logo h1{font-size:1.6rem;font-weight:700}
        .logo span{font-size:0.85rem;font-weight:400;opacity:0.9;display:block}
        .main-container{display:flex;max-width:1800px;margin:0 auto;min-height:calc(100vh - 100px); filter: blur(5px); transition: filter 0.5s;} /* 로그인 전 블러 처리 */
        .sidebar{width:300px;background:var(--bg-card);padding:1.5rem 0;border-right:1px solid var(--border);position:sticky;top:100px;height:calc(100vh - 100px);overflow-y:auto}
        .sidebar::-webkit-scrollbar{width:6px}
        .sidebar::-webkit-scrollbar-track{background:var(--bg-dark)}
        .sidebar::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
        .nav-section{margin-bottom:1.5rem}
        .nav-section-title{padding:0.75rem 1.5rem;font-size:0.75rem;font-weight:600;text-transform:uppercase;letter-spacing:1px;color:var(--text-secondary)}
        .nav-item{display:flex;align-items:center;padding:0.75rem 1.5rem;cursor:pointer;transition:all 0.2s ease;border-left:3px solid transparent;gap:0.75rem;font-size:0.9rem}
        .nav-item:hover{background:rgba(45,139,184,0.1);border-left-color:var(--primary-light)}
        .nav-item.active{background:rgba(45,139,184,0.2);border-left-color:var(--accent);color:var(--accent)}
        .nav-icon{width:20px;text-align:center;font-weight:600}
        .content{flex:1;padding:2rem;overflow-y:auto}
        .page{display:none;animation:fadeIn 0.3s ease}
        .page.active{display:block}
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
        .page-header{margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--border)}
        .page-title{font-size:1.75rem;font-weight:700;margin-bottom:0.5rem}
        .page-desc{color:var(--text-secondary);font-size:0.95rem}
        .card{background:var(--bg-card);border-radius:16px;padding:1.5rem;margin-bottom:1.5rem;border:1px solid var(--border);box-shadow:0 4px 20px rgba(0,0,0,0.2)}
        .card-title{font-size:1.1rem;font-weight:600;margin-bottom:1.25rem;color:var(--primary-light);display:flex;align-items:center;gap:0.5rem}
        .form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem}
        .form-group{margin-bottom:1rem}
        .form-label{display:block;font-size:0.85rem;font-weight:500;margin-bottom:0.5rem;color:var(--text-secondary)}
        .form-input,.form-select{width:100%;padding:0.75rem 1rem;background:var(--bg-input);border:1px solid var(--border);border-radius:8px;color:var(--text-primary);font-size:0.95rem;font-family:'JetBrains Mono',monospace;transition:all 0.2s ease}
        .form-input:focus,.form-select:focus{outline:none;border-color:var(--primary-light);box-shadow:0 0 0 3px rgba(45,139,184,0.2)}
        .form-input.editable-target{border-color:var(--warning);background:rgba(255,193,7,0.1)}
        .data-table{width:100%;border-collapse:collapse;margin-top:1rem;font-family:'JetBrains Mono',monospace;font-size:0.9rem}
        .data-table th{background:var(--bg-input);padding:0.75rem;text-align:center;font-weight:600;color:var(--primary-light);border:1px solid var(--border);font-size:0.8rem}
        .data-table td{padding:0.5rem;text-align:center;border:1px solid var(--border)}
        .data-table input{width:100%;padding:0.5rem;background:var(--bg-input);border:1px solid var(--border);border-radius:4px;color:var(--text-primary);font-family:'JetBrains Mono',monospace;font-size:0.85rem;text-align:center}
        .data-table input:focus{outline:none;border-color:var(--primary-light)}
        .data-table .calc-cell{background:rgba(45,139,184,0.1);color:var(--primary-light);font-weight:500}
        .data-table .result-cell{background:rgba(255,107,53,0.1);color:var(--accent);font-weight:600}
        .btn{padding:0.75rem 1.5rem;border:none;border-radius:8px;font-size:0.9rem;font-weight:600;cursor:pointer;transition:all 0.2s ease;display:inline-flex;align-items:center;gap:0.5rem}
        .btn-primary{background:linear-gradient(135deg,#1a5f7a 0%,#2d8bb8 100%);color:white}
        .btn-primary:hover{transform:translateY(-2px);box-shadow:0 4px 15px rgba(26,95,122,0.4)}
        .btn-accent{background:linear-gradient(135deg,#ff6b35 0%,#ff8c5a 100%);color:white}
        .btn-outline{background:transparent;border:2px solid var(--border);color:var(--text-primary)}
        .result-box{background:var(--bg-input);border:2px solid var(--accent);border-radius:12px;padding:1.25rem;text-align:center;margin-top:1rem}
        .result-label{font-size:0.85rem;color:var(--text-secondary);margin-bottom:0.5rem}
        .result-value{font-size:1.75rem;font-weight:700;color:var(--accent);font-family:'JetBrains Mono',monospace}
        .status{display:inline-flex;align-items:center;gap:0.5rem;padding:0.35rem 0.75rem;border-radius:20px;font-size:0.8rem;font-weight:600}
        .status-pass{background:rgba(40,167,69,0.2);color:var(--success)}
        .status-fail{background:rgba(220,53,69,0.2);color:var(--danger)}
        .status-warning{background:rgba(255,193,7,0.2);color:var(--warning)}
        .info-box{background:rgba(45,139,184,0.1);border-left:4px solid var(--primary-light);padding:1rem;border-radius:0 8px 8px 0;margin:1rem 0}
        .info-box h4{color:var(--primary-light);margin-bottom:0.5rem;font-size:0.95rem}
        .info-box p{color:var(--text-secondary);font-size:0.9rem}
        .formula-box{background:rgba(255,107,53,0.1);border:1px dashed var(--accent);padding:1rem;border-radius:8px;margin:1rem 0;font-family:'JetBrains Mono',monospace;font-size:0.9rem;color:var(--accent)}
        .target-edit{display:flex;align-items:center;gap:1rem;background:rgba(255,193,7,0.1);padding:1rem;border-radius:8px;margin:1rem 0;border:1px solid var(--warning)}
        .target-edit label{color:var(--warning);font-weight:600;white-space:nowrap}
        .target-edit input{width:100px;padding:0.5rem;background:var(--bg-input);border:1px solid var(--warning);border-radius:4px;color:var(--warning);font-family:'JetBrains Mono',monospace;text-align:center}
        .menu-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem;margin-top:2rem}
        .menu-card{background:var(--bg-card);border-radius:16px;padding:1.5rem;border:1px solid var(--border);cursor:pointer;transition:all 0.3s ease}
        .menu-card:hover{transform:translateY(-4px);border-color:var(--primary-light);box-shadow:0 8px 30px rgba(45,139,184,0.2)}
        .menu-card h3{font-size:1.1rem;margin-bottom:0.5rem;color:var(--text-primary)}
        .menu-card p{font-size:0.85rem;color:var(--text-secondary)}
        .menu-section-title{font-size:1.25rem;font-weight:600;color:var(--primary-light);margin:2rem 0 1rem;display:flex;align-items:center;gap:0.5rem}
        .notes-area{width:100%;min-height:100px;padding:1rem;background:var(--bg-input);border:1px solid var(--border);border-radius:8px;color:var(--text-primary);font-family:'Noto Sans KR',sans-serif;font-size:0.9rem;resize:vertical}
        .chart-container{background:var(--bg-input);border-radius:12px;padding:1.5rem;margin-top:1rem;height:400px}
        .profile-row{display:grid;grid-template-columns:80px 1fr 1fr 1fr;gap:1rem;align-items:center;padding:0.75rem;border-bottom:1px solid var(--border)}
        .profile-row:last-child{border-bottom:none}
        .profile-header{background:var(--bg-input);font-weight:600;color:var(--primary-light);border-radius:8px 8px 0 0}
        /* 테이블 래퍼 - 반응형 스크롤 */
        .table-wrapper{width:100%;overflow-x:auto;-webkit-overflow-scrolling:touch;margin:0.5rem 0}
        
        /* 모바일 메뉴 버튼 */
        .mobile-menu-btn{display:none;width:40px;height:40px;background:rgba(255,255,255,0.1);border:none;border-radius:8px;color:white;font-size:1.5rem;cursor:pointer;align-items:center;justify-content:center}
        
        /* 사이드바 오버레이 */
        .sidebar-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:998}
        .sidebar-overlay.active{display:block}
        
        /* 사이드바 닫기 버튼 */
        .sidebar-close{display:none;position:absolute;top:0.5rem;right:0.5rem;width:36px;height:36px;background:var(--bg-input);border:1px solid var(--border);border-radius:8px;color:var(--text-primary);font-size:1.25rem;cursor:pointer;align-items:center;justify-content:center;z-index:10}
        
        /* 태블릿 (1024px 이하) */
        @media (max-width:1024px){
            .sidebar{width:240px}
            .form-grid{grid-template-columns:repeat(auto-fit,minmax(140px,1fr))}
            .result-value{font-size:1.2rem}
            .chart-container{height:280px}
            .profile-row{grid-template-columns:60px repeat(3,1fr);gap:0.5rem}
        }
        
        /* 모바일 (768px 이하) */
        @media (max-width:768px){
            body{font-size:15px}
            header{padding:0.625rem 0.75rem}
            .logo-icon{width:36px;height:36px;font-size:1.1rem;border-radius:8px}
            .logo h1{font-size:0.9rem}
            .logo span{display:none}
            .header-content{flex-wrap:wrap;gap:0.5rem}
            .header-content>div:last-child{display:flex;flex-wrap:wrap;gap:0.4rem;justify-content:flex-end}
            .header-content .btn{padding:0.4rem 0.5rem;font-size:0.7rem}
            .mobile-menu-btn{display:flex}
            .main-container{flex-direction:column}
            .sidebar{position:fixed;top:0;left:0;width:280px;height:100vh;z-index:999;transform:translateX(-100%);transition:transform 0.3s ease;padding-top:3rem}
            .sidebar.open{transform:translateX(0);box-shadow:4px 0 20px rgba(0,0,0,0.5)}
            .sidebar-close{display:flex;align-items:center;justify-content:center}
            .content{padding:1rem;width:100%}
            .page-title{font-size:1.15rem}
            .page-desc{font-size:0.85rem}
            .card{padding:1rem;border-radius:10px}
            .card-title{font-size:0.95rem}
            .form-grid{grid-template-columns:1fr 1fr;gap:0.75rem}
            .form-input,.form-select{padding:0.5rem;font-size:0.85rem;min-height:44px}
            .form-label{font-size:0.75rem}
            .result-box{padding:0.75rem}
            .result-label{font-size:0.7rem}
            .result-value{font-size:1rem}
            .menu-grid{grid-template-columns:1fr;gap:0.75rem}
            .menu-card{padding:1rem}
            .menu-card h3{font-size:0.95rem}
            .menu-card p{font-size:0.8rem}
            .profile-row{grid-template-columns:50px repeat(3,1fr);gap:0.4rem;padding:0.5rem;font-size:0.8rem}
            .profile-header{font-size:0.7rem}
            .profile-row .form-input{padding:0.35rem;font-size:0.8rem}
            .chart-container{height:250px;padding:0.75rem}
            .data-table{font-size:0.75rem;min-width:450px}
            .data-table th{padding:0.4rem 0.25rem;font-size:0.65rem;white-space:nowrap}
            .data-table td{padding:0.3rem}
            .data-table input{min-width:45px;padding:0.25rem;font-size:0.7rem;min-height:32px}
            .info-box{padding:0.75rem}
            .info-box h4{font-size:0.85rem}
            .info-box p{font-size:0.8rem}
            .formula-box{padding:0.75rem;font-size:0.7rem;word-break:break-all}
            .target-edit{flex-wrap:wrap;padding:0.75rem;gap:0.5rem}
            .target-edit label{font-size:0.8rem;width:100%}
            .target-edit input{width:80px}
            .target-edit span{font-size:0.7rem}
            .btn{padding:0.5rem 0.625rem;font-size:0.75rem}
            .nav-item{padding:0.75rem 1.25rem;font-size:0.85rem}
        }
        
        /* 모바일 작은 화면 (480px 이하) */
        @media (max-width:480px){
            body{font-size:14px}
            .login-card{padding:1.5rem 1.25rem;border-radius:12px;margin:0.5rem}
            .login-logo{width:50px;height:50px;font-size:1.5rem}
            .login-card h2{font-size:1rem}
            .login-input{padding:0.75rem;font-size:0.9rem}
            .login-btn{padding:0.75rem;font-size:0.9rem}
            .login-footer{font-size:0.65rem}
            .logo-icon{width:32px;height:32px;font-size:1rem}
            .logo h1{font-size:0.8rem}
            .header-content .btn:nth-child(1),.header-content .btn:nth-child(2){display:none}
            .content{padding:0.75rem}
            .page-header{margin-bottom:1rem;padding-bottom:0.75rem}
            .page-title{font-size:1.05rem}
            .page-desc{font-size:0.8rem}
            .card{padding:0.875rem;margin-bottom:1rem}
            .card-title{font-size:0.9rem;margin-bottom:0.75rem}
            .form-grid{grid-template-columns:1fr;gap:0.625rem}
            .form-label{font-size:0.7rem}
            .form-input,.form-select{padding:0.5rem;font-size:0.8rem}
            .result-box{padding:0.625rem}
            .result-label{font-size:0.65rem}
            .result-value{font-size:0.95rem}
            .result-box small{font-size:0.6rem}
            .info-box h4{font-size:0.8rem}
            .info-box p{font-size:0.75rem}
            .formula-box{font-size:0.65rem}
            .target-edit{flex-direction:column;align-items:flex-start}
            .target-edit input{width:100%}
            .menu-section-title{font-size:1rem;margin:1.25rem 0 0.625rem}
            .menu-card h3{font-size:0.9rem}
            .menu-card p{font-size:0.75rem}
            .profile-row{grid-template-columns:40px repeat(3,1fr);gap:0.25rem;padding:0.4rem;font-size:0.7rem}
            .profile-header{font-size:0.6rem}
            .profile-row .form-input{padding:0.25rem;font-size:0.7rem}
            .chart-container{height:200px}
            .data-table{font-size:0.65rem;min-width:400px}
            .data-table th{padding:0.3rem 0.2rem;font-size:0.6rem}
            .data-table td{padding:0.25rem}
            .data-table input{min-width:40px;padding:0.2rem;font-size:0.65rem;min-height:28px}
        }
        
        /* 아주 작은 화면 (360px 이하) */
        @media (max-width:360px){
            .login-card h2{font-size:0.9rem}
            .page-title{font-size:1rem}
            .result-value{font-size:0.85rem}
            .sidebar{width:100%}
            .profile-row{grid-template-columns:1fr;text-align:center;gap:0.5rem}
            .profile-row>div:first-child{font-weight:700;border-bottom:1px dashed var(--border);padding-bottom:0.25rem}
            .profile-header{display:none}
        }
        
        /* 터치 디바이스 최적화 */
        @media (hover:none) and (pointer:coarse){
            .btn,.menu-card,.nav-item{-webkit-tap-highlight-color:transparent}
            .btn:active{transform:scale(0.98)}
            .menu-card:active{transform:translateY(-2px)}
            .nav-item{padding:0.875rem 1.25rem}
            .data-table input{min-height:36px}
            .form-input,.form-select{min-height:44px}
        }
        
        /* 인쇄 스타일 */
        @media print{.sidebar,header,#login-overlay,.mobile-menu-btn,.sidebar-overlay{display:none!important}.main-container{filter:none!important}.content{padding:0;width:100%}.card{break-inside:avoid;box-shadow:none;border:1px solid #ccc}.chart-container{break-inside:avoid}}
    </style>
</head>
<body>

<!-- 사이드바 오버레이 (모바일용) -->
<div class="sidebar-overlay" id="sidebar-overlay" onclick="closeSidebar()"></div>

<div id="login-overlay">
        <div class="login-card">
            <div class="login-logo">M</div>
            <h2 style="font-size:1.5rem;margin-bottom:0.5rem;">ED&C Moldflow & Machine Help Desk</h2>
            <p style="color:var(--text-secondary);font-size:0.9rem;">사출 성형 공정 관리 앱</p>
            
            <input type="password" id="login-pw" class="login-input" placeholder="비밀번호를 입력하세요" onkeyup="if(event.key==='Enter') tryLogin()">
            <button class="login-btn" onclick="tryLogin()">로그인</button>
            <p id="login-error" class="error-msg">⛔ 비밀번호가 올바르지 않습니다.</p>
            
            <div class="login-footer">
                Authorized Personnel Only<br>
                <span style="color:#ff6b35; font-weight:500;">사용 유효 기간: <span id="display-expire-date">2026년 2월 28일</span> 까지</span><br>
                <div style="margin-top:0.5rem; opacity:0.7;">© 2026 (주)이디앤씨 Autodesk Team</div>
            </div>
        </div>
    </div>

    <header>
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">M</div>
                <div><h1>Moldflow Help Desk</h1><span>사출 성형 공정 관리 시스템 v2.0</span></div>
            </div>
            <div style="display:flex;gap:0.5rem;align-items:center;flex-wrap:wrap;">
                <button class="btn btn-outline" id="theme-toggle" onclick="toggleTheme()" aria-pressed="false" title="화면 색상 반전">🌞 밝게</button>
                <button class="btn btn-outline" onclick="window.print()">📄 인쇄</button>
                <button class="btn btn-accent" onclick="resetAllData()">🔄 초기화</button>
                <button class="btn btn-outline" style="border-color:var(--danger);color:var(--danger);" onclick="doLogout()">🔒 잠금</button>
                <button class="mobile-menu-btn" onclick="openSidebar()" aria-label="메뉴 열기">☰</button>
            </div>
        </div>
    </header>
    <div class="main-container" id="main-app">
        <nav class="sidebar" id="sidebar">
            <button class="sidebar-close" onclick="closeSidebar()" aria-label="메뉴 닫기">✕</button>
            <div class="nav-section">
                <div class="nav-section-title">시작</div>
                <div class="nav-item active" data-page="start"><span class="nav-icon">🏠</span> 시작 메뉴</div>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">🧮 사출성형 계산기</div>
                <div class="nav-item" data-page="metering-calc"><span class="nav-icon">⚙️</span> 계량 계산기</div>
                <div class="nav-item" data-page="fill-control"><span class="nav-icon">📈</span> 충전 제어 계산기</div>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">기계 검증</div>
                <div class="nav-item" data-page="speed-linearity"><span class="nav-icon">📊</span> 사출 속도 선형성</div>
                <div class="nav-item" data-page="load-sensitivity"><span class="nav-icon">⚖️</span> 부하 민감도</div>
                <div class="nav-item" data-page="check-ring"><span class="nav-icon">🔄</span> 체크링 반복성</div>
                <div class="nav-item" data-page="pressure-response"><span class="nav-icon">📈</span> 압력 응답성</div>
                <div class="nav-item" data-page="platen-deflection"><span class="nav-icon">📐</span> 금형형판 변형</div>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">공정 개발</div>
                <div class="nav-item" data-page="clamp-force"><span class="nav-icon">🔧</span> 형체력 계산</div>
                <div class="nav-item" data-page="melt-temp"><span class="nav-icon">🌡️</span> 용융 온도</div>
                <div class="nav-item" data-page="fill-flow"><span class="nav-icon">💧</span> 충전 유량</div>
                <div class="nav-item" data-page="hold-time"><span class="nav-icon">⏱️</span> 보압 시간</div>
                <div class="nav-item" data-page="cavity-imbalance"><span class="nav-icon">⚖️</span> 캐비티 불균형</div>
                <div class="nav-item" data-page="pressure-loss"><span class="nav-icon">📉</span> 압력 손실</div>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">냉각 최적화</div>
                <div class="nav-item" data-page="cooling"><span class="nav-icon">❄️</span> 냉각 최적화</div>
                <div class="nav-item" data-page="water-flow"><span class="nav-icon">🌊</span> 냉각수 유량</div>
                <div class="nav-item" data-page="mold-deflection"><span class="nav-icon">📏</span> 금형 변형</div>
            </div>
            <div class="nav-section">
                <div class="nav-section-title">투자 분석</div>
                <div class="nav-item" data-page="roi"><span class="nav-icon">💰</span> ROI 계산</div>
            </div>
        </nav>
        <main class="content">
            <div id="page-start" class="page active">
                <div class="page-header">
                    <h2 class="page-title">Moldflow Help Desk에 오신 것을 환영합니다</h2>
                    <p class="page-desc">사출 성형 공정 관리 및 검증을 위한 종합 도구입니다. 모든 판정 기준은 편집 가능합니다.</p>
                </div>
                <h3 class="menu-section-title">🧮 사출성형 계산기 (신규)</h3>
                <div class="menu-grid">
                    <div class="menu-card" onclick="navigateTo('metering-calc')"><h3>⚙️ 계량 계산기</h3><p>제품 체적, 수지 밀도, 스크류 직경으로 최적 계량값을 자동 계산합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('fill-control')"><h3>📈 충전 제어 계산기</h3><p>4단 속도/거리 프로파일을 설정하고 그래프로 시각화합니다.</p></div>
                </div>
                <h3 class="menu-section-title">🔧 기계 검증</h3>
                <div class="menu-grid">
                    <div class="menu-card" onclick="navigateTo('speed-linearity')"><h3>📊 사출 속도 선형성</h3><p>설정 속도와 실제 속도의 차이를 분석합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('load-sensitivity')"><h3>⚖️ 부하 민감도</h3><p>금형 샷과 에어 샷의 차이를 비교합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('check-ring')"><h3>🔄 체크링 반복성</h3><p>체크링 씰의 일관성을 측정합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('pressure-response')"><h3>📈 압력 응답성</h3><p>V→P 전환의 응답성을 측정합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('platen-deflection')"><h3>📐 금형형판 변형</h3><p>보압 중 고정 금형형판의 변형을 측정합니다.</p></div>
                </div>
                <h3 class="menu-section-title">⚙️ 공정 개발</h3>
                <div class="menu-grid">
                    <div class="menu-card" onclick="navigateTo('clamp-force')"><h3>🔧 최소 형체력</h3><p>투영 면적과 재료 계수로 최소 형체력을 계산합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('melt-temp')"><h3>🌡️ 용융 온도</h3><p>실제 용융 온도와 목표 범위를 비교합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('fill-flow')"><h3>💧 충전 유량</h3><p>최적의 체적 유량을 결정합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('hold-time')"><h3>⏱️ 보압 시간</h3><p>게이트 씰 시간을 결정합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('cavity-imbalance')"><h3>⚖️ 캐비티 불균형</h3><p>다수 캐비티의 중량 편차를 측정합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('pressure-loss')"><h3>📉 압력 손실</h3><p>금형 구성요소별 압력 손실을 측정합니다.</p></div>
                </div>
                <h3 class="menu-section-title">❄️ 냉각 최적화 & ROI</h3>
                <div class="menu-grid">
                    <div class="menu-card" onclick="navigateTo('cooling')"><h3>❄️ 냉각 최적화</h3><p>재료별 이젝션 온도 범위를 확인합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('water-flow')"><h3>🌊 냉각수 유량</h3><p>냉각 회로의 난류 흐름을 확인합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('mold-deflection')"><h3>📏 금형 변형</h3><p>보압 중 금형 변형을 측정합니다.</p></div>
                    <div class="menu-card" onclick="navigateTo('roi')"><h3>💰 ROI 계산</h3><p>사이클 타임 개선의 비용 절감을 계산합니다.</p></div>
                </div>
            </div>

            <div id="page-metering-calc" class="page">
                <div class="page-header">
                    <h2 class="page-title">⚙️ 계량 계산기 (Metering Calculator)</h2>
                    <p class="page-desc">제품의 체적과 수지 특성을 기반으로 최적의 계량값(Shot Size)을 자동으로 계산합니다.</p>
                </div>
                
                <div class="card">
                    <h3 class="card-title">ℹ️ 개요 및 원리</h3>
                    <div class="info-box">
                        <h4>계량(Metering)이란?</h4>
                        <p>계량은 사출 성형에서 스크류가 후퇴하면서 배럴 앞쪽에 용융 수지를 축적하는 과정입니다. 정확한 계량값 설정은 일관된 제품 품질을 위해 매우 중요합니다.</p>
                    </div>
                    <div class="info-box" style="margin-top:1rem;">
                        <h4>계산 원리</h4>
                        <p>
                            <strong>1단계:</strong> 제품 체적 × 고체 밀도 = 제품 중량<br>
                            <strong>2단계:</strong> 제품 중량 ÷ 용융 밀도 = 용융 체적<br>
                            <strong>3단계:</strong> 용융 체적 ÷ 스크류 단면적 = 이론 스트로크<br>
                            <strong>4단계:</strong> 이론 스트로크 ÷ 사출기 효율 = 실제 계량값
                        </p>
                    </div>
                    <div class="formula-box">
                        <strong>계산식:</strong><br>
                        계량값 (mm) = (제품체적 × 고체밀도 ÷ 용융밀도) ÷ (π × (스크류직경/2)² ) ÷ 효율<br><br>
                        <strong>또는:</strong><br>
                        계량값 (mm) = (제품중량 ÷ 용융밀도) ÷ 스크류단면적 ÷ 효율
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">📝 입력 파라미터</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(3,1fr);">
                        <div class="form-group">
                            <label class="form-label">제품 체적 (cm³)</label>
                            <input type="number" class="form-input" id="mc-volume" step="0.01" value="50" oninput="calcMetering()">
                            <small style="color:var(--text-secondary);">CAD 또는 Moldflow에서 확인</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label">캐비티 수</label>
                            <input type="number" class="form-input" id="mc-cavities" value="1" min="1" oninput="calcMetering()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">러너/스프루 체적 (cm³)</label>
                            <input type="number" class="form-input" id="mc-runner" step="0.01" value="5" oninput="calcMetering()">
                            <small style="color:var(--text-secondary);">콜드러너의 경우 포함</small>
                        </div>
                    </div>
                    <div class="form-grid" style="grid-template-columns:repeat(3,1fr);margin-top:1rem;">
                        <div class="form-group">
                            <label class="form-label">고체 밀도 (g/cm³)</label>
                            <input type="number" class="form-input" id="mc-solid-density" step="0.001" value="1.05" oninput="calcMetering()">
                            <small style="color:var(--text-secondary);">예: ABS 1.05, PP 0.91, PC 1.20</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label">용융 밀도 (g/cm³)</label>
                            <input type="number" class="form-input" id="mc-melt-density" step="0.001" value="0.95" oninput="calcMetering()">
                            <small style="color:var(--text-secondary);">고체밀도의 85~95% 수준</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label">PVT 보정계수</label>
                            <input type="number" class="form-input" id="mc-pvt" step="0.01" value="1.0" oninput="calcMetering()">
                            <small style="color:var(--text-secondary);">일반적으로 1.0~1.1</small>
                        </div>
                    </div>
                    <div class="form-grid" style="grid-template-columns:repeat(3,1fr);margin-top:1rem;">
                        <div class="form-group">
                            <label class="form-label">스크류 직경 (mm)</label>
                            <input type="number" class="form-input" id="mc-screw-dia" step="0.1" value="45" oninput="calcMetering()">
                            <small style="color:var(--text-secondary);">사출기 사양 확인</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label">사출기 효율 (%)</label>
                            <input type="number" class="form-input" id="mc-efficiency" step="1" value="95" min="80" max="100" oninput="calcMetering()">
                            <small style="color:var(--text-secondary);">체크링 효율 (보통 90~98%)</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label">쿠션량 (mm)</label>
                            <input type="number" class="form-input" id="mc-cushion" step="0.1" value="5" oninput="calcMetering()">
                            <small style="color:var(--text-secondary);">보압 후 잔여량 (3~10mm)</small>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">📊 계산 결과</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(4,1fr);">
                        <div class="result-box">
                            <div class="result-label">총 제품 체적</div>
                            <div class="result-value" id="mc-total-volume">--</div>
                            <small>cm³</small>
                        </div>
                        <div class="result-box">
                            <div class="result-label">총 샷 중량</div>
                            <div class="result-value" id="mc-shot-weight">--</div>
                            <small>g</small>
                        </div>
                        <div class="result-box">
                            <div class="result-label">용융 체적</div>
                            <div class="result-value" id="mc-melt-volume">--</div>
                            <small>cm³</small>
                        </div>
                        <div class="result-box">
                            <div class="result-label">스크류 단면적</div>
                            <div class="result-value" id="mc-screw-area">--</div>
                            <small>mm²</small>
                        </div>
                    </div>
                    <div class="form-grid" style="grid-template-columns:repeat(3,1fr);margin-top:1rem;">
                        <div class="result-box" style="border-color:var(--success);">
                            <div class="result-label">이론 스트로크</div>
                            <div class="result-value" id="mc-theory-stroke" style="color:var(--success);">--</div>
                            <small>mm</small>
                        </div>
                        <div class="result-box" style="border-color:var(--warning);">
                            <div class="result-label">실제 계량값</div>
                            <div class="result-value" id="mc-actual-metering" style="color:var(--warning);">--</div>
                            <small>mm (효율 적용)</small>
                        </div>
                        <div class="result-box" style="border-color:var(--accent);">
                            <div class="result-label">권장 설정값</div>
                            <div class="result-value" id="mc-recommended" style="color:var(--accent);">--</div>
                            <small>mm (쿠션 포함)</small>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">📋 일반 수지 밀도 참조표</h3>
                    <div class="table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr><th>수지</th><th>고체 밀도 (g/cm³)</th><th>용융 밀도 (g/cm³)</th><th>비고</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>ABS</td><td>1.04~1.07</td><td>0.94~0.97</td><td>범용</td></tr>
                            <tr><td>PP</td><td>0.90~0.91</td><td>0.77~0.82</td><td>결정성</td></tr>
                            <tr><td>PE-HD</td><td>0.94~0.97</td><td>0.78~0.83</td><td>결정성</td></tr>
                            <tr><td>PC</td><td>1.20~1.22</td><td>1.06~1.10</td><td>비정질</td></tr>
                            <tr><td>PA6</td><td>1.12~1.14</td><td>0.98~1.02</td><td>결정성</td></tr>
                            <tr><td>PA66</td><td>1.13~1.15</td><td>0.99~1.03</td><td>결정성</td></tr>
                            <tr><td>POM</td><td>1.41~1.43</td><td>1.20~1.26</td><td>결정성</td></tr>
                            <tr><td>PBT</td><td>1.30~1.32</td><td>1.13~1.18</td><td>결정성</td></tr>
                            <tr><td>PMMA</td><td>1.17~1.20</td><td>1.05~1.08</td><td>비정질</td></tr>
                            <tr><td>PS</td><td>1.04~1.06</td><td>0.95~0.98</td><td>비정질</td></tr>
                        </tbody>
                    </table>
                    </div>
                </div>
            </div>

            <div id="page-fill-control" class="page">
                <div class="page-header">
                    <h2 class="page-title">📈 충전 제어 계산기 (Fill Control Calculator)</h2>
                    <p class="page-desc">Moldflow 해석 결과를 바탕으로 사출기의 다단 속도/위치 프로파일을 설정합니다.</p>
                </div>

                <div class="card">
                    <h3 class="card-title">ℹ️ 개요 및 원리</h3>
                    <div class="info-box">
                        <h4>충전 제어(Fill Control)란?</h4>
                        <p>사출 성형에서 충전 단계는 용융 수지가 금형 캐비티를 채우는 과정입니다. 다단 속도 제어를 통해 게이트 통과, 두꺼운 부분, 얇은 부분 등 각 영역에 맞는 최적의 충전 속도를 설정할 수 있습니다.</p>
                    </div>
                    <div class="formula-box">
                        <strong>위치 계산식:</strong><br>
                        스크류 위치 = 계량값 - (해당 시점까지 충전된 체적 ÷ 스크류 단면적)<br><br>
                        <strong>속도 계산식:</strong><br>
                        사출 속도 (mm/s) = 체적 유량 (cm³/s) ÷ 스크류 단면적 (cm²) × 10
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">📝 기본 설정</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(4,1fr);">
                        <div class="form-group">
                            <label class="form-label">계량값 (Starting Position, mm)</label>
                            <input type="number" class="form-input" id="fc-metering" step="0.1" value="80" oninput="calcFillControl()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">스크류 직경 (mm)</label>
                            <input type="number" class="form-input" id="fc-screw-dia" step="0.1" value="45" oninput="calcFillControl()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">V→P 전환 위치 (mm)</label>
                            <input type="number" class="form-input" id="fc-vp-position" step="0.1" value="10" oninput="calcFillControl()">
                        </div>
                        <div class="form-group">
                            <label class="form-label">총 충전 시간 (sec)</label>
                            <input type="number" class="form-input" id="fc-fill-time" step="0.01" value="1.5" oninput="calcFillControl()">
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">🎚️ 4단 속도/위치 프로파일 설정</h3>
                    <div class="info-box">
                        <p><strong>1단계:</strong> 게이트 통과 구간 (저속으로 시작하여 jetting 방지)<br>
                        <strong>2단계:</strong> 주요 충전 구간 (고속 충전)<br>
                        <strong>3단계:</strong> 두꺼운 부분 또는 유동 말단 (속도 조절)<br>
                        <strong>4단계:</strong> V→P 전환 전 (감속하여 압력 피크 방지)</p>
                    </div>
                    
                    <div class="profile-row profile-header">
                        <div>단계</div>
                        <div>시작 위치 (mm)</div>
                        <div>종료 위치 (mm)</div>
                        <div>속도 (mm/s)</div>
                    </div>
                    <div class="profile-row">
                        <div style="font-weight:600;color:var(--primary-light);">1단</div>
                        <div><input type="number" class="form-input" id="fc-pos1-start" value="80" oninput="calcFillControl()"></div>
                        <div><input type="number" class="form-input" id="fc-pos1-end" value="65" oninput="calcFillControl()"></div>
                        <div><input type="number" class="form-input" id="fc-speed1" value="30" oninput="calcFillControl()"></div>
                    </div>
                    <div class="profile-row">
                        <div style="font-weight:600;color:var(--success);">2단</div>
                        <div><input type="number" class="form-input" id="fc-pos2-start" value="65" readonly style="background:var(--bg-dark);"></div>
                        <div><input type="number" class="form-input" id="fc-pos2-end" value="40" oninput="calcFillControl()"></div>
                        <div><input type="number" class="form-input" id="fc-speed2" value="80" oninput="calcFillControl()"></div>
                    </div>
                    <div class="profile-row">
                        <div style="font-weight:600;color:var(--warning);">3단</div>
                        <div><input type="number" class="form-input" id="fc-pos3-start" value="40" readonly style="background:var(--bg-dark);"></div>
                        <div><input type="number" class="form-input" id="fc-pos3-end" value="20" oninput="calcFillControl()"></div>
                        <div><input type="number" class="form-input" id="fc-speed3" value="60" oninput="calcFillControl()"></div>
                    </div>
                    <div class="profile-row">
                        <div style="font-weight:600;color:var(--accent);">4단</div>
                        <div><input type="number" class="form-input" id="fc-pos4-start" value="20" readonly style="background:var(--bg-dark);"></div>
                        <div><input type="number" class="form-input" id="fc-pos4-end" value="10" oninput="calcFillControl()"></div>
                        <div><input type="number" class="form-input" id="fc-speed4" value="25" oninput="calcFillControl()"></div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">📊 계산 결과</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(4,1fr);">
                        <div class="result-box">
                            <div class="result-label">총 스트로크</div>
                            <div class="result-value" id="fc-total-stroke">--</div>
                            <small>mm</small>
                        </div>
                        <div class="result-box">
                            <div class="result-label">총 충전 체적</div>
                            <div class="result-value" id="fc-total-volume">--</div>
                            <small>cm³</small>
                        </div>
                        <div class="result-box">
                            <div class="result-label">평균 속도</div>
                            <div class="result-value" id="fc-avg-speed">--</div>
                            <small>mm/s</small>
                        </div>
                        <div class="result-box">
                            <div class="result-label">예상 충전 시간</div>
                            <div class="result-value" id="fc-calc-time">--</div>
                            <small>sec</small>
                        </div>
                    </div>
                    
                    <div class="table-wrapper">
                    <table class="data-table" style="margin-top:1.5rem;">
                        <thead>
                            <tr><th>단계</th><th>거리 (mm)</th><th>체적 (cm³)</th><th>시간 (sec)</th><th>체적유량 (cm³/s)</th></tr>
                        </thead>
                        <tbody>
                            <tr><td>1단</td><td id="fc-dist1">--</td><td id="fc-vol1">--</td><td id="fc-time1">--</td><td id="fc-flow1">--</td></tr>
                            <tr><td>2단</td><td id="fc-dist2">--</td><td id="fc-vol2">--</td><td id="fc-time2">--</td><td id="fc-flow2">--</td></tr>
                            <tr><td>3단</td><td id="fc-dist3">--</td><td id="fc-vol3">--</td><td id="fc-time3">--</td><td id="fc-flow3">--</td></tr>
                            <tr><td>4단</td><td id="fc-dist4">--</td><td id="fc-vol4">--</td><td id="fc-time4">--</td><td id="fc-flow4">--</td></tr>
                        </tbody>
                    </table>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">📈 속도/위치 프로파일 그래프</h3>
                    <div class="chart-container">
                        <canvas id="fillProfileChart"></canvas>
                    </div>
                </div>
            </div>
            <div id="page-speed-linearity" class="page">
                <div class="page-header">
                    <h2 class="page-title">📊 사출 속도 선형성 연구</h2>
                    <p class="page-desc">기계 컨트롤러의 설정값과 실제 출력값의 일치 정도를 확인합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적 및 절차</h3>
                    <div class="info-box">
                        <h4>목적</h4>
                        <p>기계 컨트롤러의 설정 속도와 실제 생산 속도가 얼마나 일치하는지 확인합니다. 결과는 금형 또는 공정 기록에 보관해야 합니다.</p>
                    </div>
                    <div class="info-box" style="margin-top:1rem;">
                        <h4>필요 장비</h4>
                        <p>• 폐루프 1단계 사출이 가능한 사출성형기</p>
                    </div>
                    <div class="formula-box">
                        <strong>계산식:</strong><br>
                        예상 충전시간 = 선형 스트로크 ÷ 설정 속도<br>
                        실제 평균속도 = 선형 스트로크 ÷ 실제 충전시간<br>
                        속도 변화율 (%) = (실제 평균속도 - 설정 속도) ÷ 설정 속도 × 100
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">⚙️ 판정 기준 설정</h3>
                    <div class="target-edit">
                        <label>⚠️ 목표 속도 변화율 (±%):</label>
                        <input type="number" id="sl-target" value="5" step="0.5" oninput="calcSpeedLinearity()">
                        <span style="color:var(--text-secondary);">권장값: ±5% 이내</span>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📝 기본 정보</h3>
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">작업자명</label><input type="text" class="form-input" id="sl-name"></div>
                        <div class="form-group"><label class="form-label">날짜</label><input type="date" class="form-input" id="sl-date"></div>
                        <div class="form-group"><label class="form-label">기계</label><input type="text" class="form-input" id="sl-machine"></div>
                        <div class="form-group"><label class="form-label">선형 스트로크 (mm)</label><input type="number" class="form-input" id="sl-stroke" step="0.01" oninput="calcSpeedLinearity()"></div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 테스트 데이터</h3>
                    <div class="table-wrapper">
                    <table class="data-table">
                        <thead><tr><th>샷 #</th><th>설정 속도 (mm/s)</th><th>실제 충전 시간 (sec)</th><th>예상 충전 시간</th><th>실제 평균 속도</th><th>속도 변화율 (%)</th><th>판정</th></tr></thead>
                        <tbody id="sl-table-body"></tbody>
                    </table>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📈 종합 결과</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(3,1fr);">
                        <div class="result-box"><div class="result-label">합격 항목</div><div class="result-value" id="sl-pass-count">--</div></div>
                        <div class="result-box"><div class="result-label">불합격 항목</div><div class="result-value" id="sl-fail-count" style="color:var(--danger);">--</div></div>
                        <div class="result-box"><div class="result-label">종합 판정</div><div id="sl-overall-status">--</div></div>
                    </div>
                </div>
            </div>

            <div id="page-load-sensitivity" class="page">
                <div class="page-header">
                    <h2 class="page-title">⚖️ 부하 민감도 연구</h2>
                    <p class="page-desc">금형 샷과 에어 샷을 비교하여 기계의 부하 민감도를 평가합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적 및 절차</h3>
                    <div class="info-box">
                        <h4>목적</h4>
                        <p>금형에 사출할 때와 공기 중으로 사출할 때의 충전 시간 및 압력 차이를 비교하여 기계가 부하 변화에 얼마나 민감하게 반응하는지 평가합니다.</p>
                    </div>
                    <div class="formula-box">
                        <strong>계산식:</strong><br>
                        충전 시간 변화율 (%) = (금형샷 충전시간 - 에어샷 충전시간) ÷ 에어샷 충전시간 × 100<br>
                        피크 압력 변화율 (%) = (금형샷 피크압력 - 에어샷 피크압력) ÷ 에어샷 피크압력 × 100
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">⚙️ 판정 기준 설정</h3>
                    <div class="form-grid" style="grid-template-columns:1fr 1fr;">
                        <div class="target-edit">
                            <label>⚠️ 충전 시간 변화율 (±%):</label>
                            <input type="number" id="ls-time-target" value="5" step="0.5" oninput="calcLoadSensitivity()">
                        </div>
                        <div class="target-edit">
                            <label>⚠️ 피크 압력 변화율 (±%):</label>
                            <input type="number" id="ls-pressure-target" value="7.25" step="0.25" oninput="calcLoadSensitivity()">
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 측정 데이터</h3>
                    <div class="form-grid" style="grid-template-columns:1fr 1fr;">
                        <div style="background:rgba(45,139,184,0.1);padding:1rem;border-radius:8px;border:1px solid var(--primary-light);">
                            <h4 style="color:var(--primary-light);margin-bottom:1rem;">금형 샷 (Mold Shot)</h4>
                            <div class="form-group"><label class="form-label">충전 시간 (sec)</label><input type="number" class="form-input" id="ls-mold-fill-time" step="0.001" oninput="calcLoadSensitivity()"></div>
                            <div class="form-group"><label class="form-label">피크 충전 압력 (MPa)</label><input type="number" class="form-input" id="ls-mold-peak-pressure" step="0.1" oninput="calcLoadSensitivity()"></div>
                        </div>
                        <div style="background:rgba(255,107,53,0.1);padding:1rem;border-radius:8px;border:1px solid var(--accent);">
                            <h4 style="color:var(--accent);margin-bottom:1rem;">에어 샷 (Air Shot)</h4>
                            <div class="form-group"><label class="form-label">충전 시간 (sec)</label><input type="number" class="form-input" id="ls-air-fill-time" step="0.001" oninput="calcLoadSensitivity()"></div>
                            <div class="form-group"><label class="form-label">피크 충전 압력 (MPa)</label><input type="number" class="form-input" id="ls-air-peak-pressure" step="0.1" oninput="calcLoadSensitivity()"></div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📈 결과</h3>
                    <div class="form-grid" style="grid-template-columns:1fr 1fr;">
                        <div class="result-box"><div class="result-label">충전 시간 변화율</div><div class="result-value" id="ls-time-change">--%</div><div id="ls-time-status"></div></div>
                        <div class="result-box"><div class="result-label">피크 압력 변화율</div><div class="result-value" id="ls-pressure-change">--%</div><div id="ls-pressure-status"></div></div>
                    </div>
                </div>
            </div>

            <div id="page-check-ring" class="page">
                <div class="page-header">
                    <h2 class="page-title">🔄 동적 체크링 반복성 연구</h2>
                    <p class="page-desc">체크링 씰의 일관성을 확인하고 잠재적 누출을 조사합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적 및 절차</h3>
                    <div class="info-box">
                        <h4>목적</h4>
                        <p>체크링 씰의 일관성을 확인하고 잠재적인 누출 여부를 조사합니다. 10개의 충전 전용 숏에서 부품 중량 변동을 측정합니다.</p>
                    </div>
                    <div class="info-box" style="margin-top:1rem;">
                        <h4>필요 장비</h4>
                        <p>• 폐루프 1단계 사출이 가능한 사출성형기<br>• 총 부품 중량의 1% 이내 정확도를 가진 저울</p>
                    </div>
                    <div class="formula-box">
                        <strong>계산식:</strong><br>
                        변동률 (%) = (최대 중량 - 최소 중량) ÷ 평균 중량 × 100
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">⚙️ 판정 기준 설정</h3>
                    <div class="target-edit">
                        <label>⚠️ 목표 변동률 (% 이하):</label>
                        <input type="number" id="cr-target" value="3" step="0.5" oninput="calcCheckRing()">
                        <span style="color:var(--text-secondary);">권장값: 3% 이하</span>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 부품 중량 데이터 (g)</h3>
                    <div class="table-wrapper">
                    <table class="data-table">
                        <thead><tr><th>샷 #</th><th>부품 중량</th><th>샷 #</th><th>부품 중량</th></tr></thead>
                        <tbody>
                            <tr><td>1</td><td><input type="number" id="cr-w1" step="0.001" oninput="calcCheckRing()"></td><td>6</td><td><input type="number" id="cr-w6" step="0.001" oninput="calcCheckRing()"></td></tr>
                            <tr><td>2</td><td><input type="number" id="cr-w2" step="0.001" oninput="calcCheckRing()"></td><td>7</td><td><input type="number" id="cr-w7" step="0.001" oninput="calcCheckRing()"></td></tr>
                            <tr><td>3</td><td><input type="number" id="cr-w3" step="0.001" oninput="calcCheckRing()"></td><td>8</td><td><input type="number" id="cr-w8" step="0.001" oninput="calcCheckRing()"></td></tr>
                            <tr><td>4</td><td><input type="number" id="cr-w4" step="0.001" oninput="calcCheckRing()"></td><td>9</td><td><input type="number" id="cr-w9" step="0.001" oninput="calcCheckRing()"></td></tr>
                            <tr><td>5</td><td><input type="number" id="cr-w5" step="0.001" oninput="calcCheckRing()"></td><td>10</td><td><input type="number" id="cr-w10" step="0.001" oninput="calcCheckRing()"></td></tr>
                        </tbody>
                    </table>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📈 결과</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(4,1fr);">
                        <div class="result-box"><div class="result-label">평균 중량</div><div class="result-value" id="cr-avg">--</div></div>
                        <div class="result-box"><div class="result-label">최대 중량</div><div class="result-value" id="cr-max">--</div></div>
                        <div class="result-box"><div class="result-label">최소 중량</div><div class="result-value" id="cr-min">--</div></div>
                        <div class="result-box"><div class="result-label">변동률 (%)</div><div class="result-value" id="cr-variation">--%</div><div id="cr-status"></div></div>
                    </div>
                </div>
            </div>

            <div id="page-pressure-response" class="page">
                <div class="page-header">
                    <h2 class="page-title">📈 압력 응답성 연구</h2>
                    <p class="page-desc">1단계(속도)에서 2단계(압력)로의 전환 응답성을 측정합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적 및 절차</h3>
                    <div class="info-box">
                        <h4>목적</h4>
                        <p>속도 제어에서 압력 제어로의 전환(V→P Transfer)이 얼마나 빠르고 안정적으로 이루어지는지 확인합니다.</p>
                    </div>
                    <div class="info-box" style="margin-top:1rem;">
                        <h4>측정 방법</h4>
                        <p>T1: V→P 전환 시점의 시간<br>T2: 보압이 안정화된 시점의 시간<br>응답성 지수 = T2 - T1 (낮을수록 좋음)</p>
                    </div>
                    <div class="formula-box">
                        <strong>계산식:</strong><br>
                        압력 응답성 지수 = T2 - T1 (sec)
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">⚙️ 판정 기준 설정</h3>
                    <div class="target-edit">
                        <label>⚠️ 목표 응답성 지수 (sec 이하):</label>
                        <input type="number" id="pr-target" value="0.20" step="0.01" oninput="calcPressureResponse()">
                        <span style="color:var(--text-secondary);">권장값: 0.20 이하</span>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 측정 데이터</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(2,1fr);">
                        <div class="form-group"><label class="form-label">T1 - V→P 전환 시점 (sec)</label><input type="number" class="form-input" id="pr-t1" step="0.001" oninput="calcPressureResponse()"></div>
                        <div class="form-group"><label class="form-label">T2 - 보압 안정 시점 (sec)</label><input type="number" class="form-input" id="pr-t2" step="0.001" oninput="calcPressureResponse()"></div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📈 결과</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(2,1fr);">
                        <div class="result-box"><div class="result-label">시간 차이 (T2 - T1)</div><div class="result-value" id="pr-time-diff">-- sec</div></div>
                        <div class="result-box"><div class="result-label">판정</div><div class="result-value" id="pr-index">--</div><div id="pr-status"></div></div>
                    </div>
                </div>
            </div>

            <div id="page-platen-deflection" class="page">
                <div class="page-header">
                    <h2 class="page-title">📐 금형형판 변형 연구</h2>
                    <p class="page-desc">성형 사이클 중 고정 금형형판의 변형량을 측정합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적 및 절차</h3>
                    <div class="info-box">
                        <h4>목적</h4>
                        <p>성형 사이클 동안 고정 금형형판의 변형량을 확인합니다. 결과는 금형 또는 공정 기록에 보관해야 합니다.</p>
                    </div>
                    <div class="info-box" style="margin-top:1rem;">
                        <h4>필요 장비</h4>
                        <p>• 금형이 장착된 사출성형기<br>• 조절 가능한 암이 있는 마그네틱 베이스의 다이얼 인디케이터</p>
                    </div>
                    <div class="info-box" style="margin-top:1rem;">
                        <h4>절차</h4>
                        <p>1. 표준 성형조건(사출로 95~99%를 채우고 보압전환)공정으로 기계 설정<br>
                        2. 인디케이터 설치 (마그네틱 베이스를 기계에 부착, 다이얼 인디케이터를 고정 금형형판 중앙 근처에 접촉)<br>
                        3. 인디케이터 영점 조정<br>
                        4. 5사이클 운전 후 보압 및 유지 중 금형형판 변형량 기록</p>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 변형 측정 데이터 (mm)</h3>
                    <table class="data-table">
                        <thead><tr><th>사이클 #</th><th>변형량 (mm)</th></tr></thead>
                        <tbody>
                            <tr><td>1</td><td><input type="number" id="pd-d1" step="0.001" oninput="calcPlatenDeflection()"></td></tr>
                            <tr><td>2</td><td><input type="number" id="pd-d2" step="0.001" oninput="calcPlatenDeflection()"></td></tr>
                            <tr><td>3</td><td><input type="number" id="pd-d3" step="0.001" oninput="calcPlatenDeflection()"></td></tr>
                            <tr><td>4</td><td><input type="number" id="pd-d4" step="0.001" oninput="calcPlatenDeflection()"></td></tr>
                            <tr><td>5</td><td><input type="number" id="pd-d5" step="0.001" oninput="calcPlatenDeflection()"></td></tr>
                        </tbody>
                    </table>
                </div>
                <div class="card">
                    <h3 class="card-title">📈 결과</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(3,1fr);">
                        <div class="result-box"><div class="result-label">평균 변형량</div><div class="result-value" id="pd-avg">--</div></div>
                        <div class="result-box"><div class="result-label">최대 변형량</div><div class="result-value" id="pd-max">--</div></div>
                        <div class="result-box"><div class="result-label">최소 변형량</div><div class="result-value" id="pd-min">--</div></div>
                    </div>
                </div>
            </div>

            <div id="page-clamp-force" class="page">
                <div class="page-header">
                    <h2 class="page-title">🔧 최소 형체력 계산</h2>
                    <p class="page-desc">특정 사출 금형을 적절히 체결하는 데 필요한 최소 형체력(톤수)을 결정합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적 및 원리</h3>
                    <div class="info-box"><h4>목적</h4><p>특정 사출 금형을 적절히 체결하는 데 필요한 최소 형체력(톤수)을 결정합니다.</p></div>
                    <div class="formula-box"><strong>계산식:</strong><br>투영 면적 = (형상 면적 - 셧오프 면적) × 캐비티 수<br>최소 형체력 (ton) = 총 투영 면적 (cm²) × 톤수 계수 (ton/cm²)</div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 파트 영역 계산</h3>
                    <table class="data-table">
                        <thead><tr><th>파트</th><th>형상 면적 (mm²)</th><th>셧오프 면적 (mm²)</th><th>수량</th><th>면적 (mm²)</th></tr></thead>
                        <tbody>
                            <tr><td>파트 1</td><td><input type="number" id="cf-shape1" oninput="calcClampForce()"></td><td><input type="number" id="cf-shut1" oninput="calcClampForce()"></td><td><input type="number" id="cf-qty1" value="1" oninput="calcClampForce()"></td><td class="calc-cell" id="cf-area1">--</td></tr>
                            <tr><td>파트 2</td><td><input type="number" id="cf-shape2" oninput="calcClampForce()"></td><td><input type="number" id="cf-shut2" oninput="calcClampForce()"></td><td><input type="number" id="cf-qty2" value="1" oninput="calcClampForce()"></td><td class="calc-cell" id="cf-area2">--</td></tr>
                            <tr><td>러너</td><td><input type="number" id="cf-shape3" oninput="calcClampForce()"></td><td><input type="number" id="cf-shut3" value="0" oninput="calcClampForce()"></td><td><input type="number" id="cf-qty3" value="1" oninput="calcClampForce()"></td><td class="calc-cell" id="cf-area3">--</td></tr>
                        </tbody>
                        <tfoot><tr><td colspan="4" style="text-align:right;font-weight:600;">총 투영 면적:</td><td class="result-cell" id="cf-total-area">--</td></tr></tfoot>
                    </table>
                </div>
                <div class="card">
                    <h3 class="card-title">🔧 형체력 계산</h3>
                    <div class="form-grid" style="grid-template-columns:1fr 1fr 1fr;">
                        <div class="form-group"><label class="form-label">총 투영 면적 (cm²)</label><input type="number" class="form-input" id="cf-proj-area" readonly></div>
                        <div class="form-group"><label class="form-label">톤수 계수 (ton/cm²)</label><input type="number" class="form-input" id="cf-tonnage-factor" step="0.1" value="0.4" oninput="calcClampForce()"><small style="color:var(--text-secondary);">일반: 0.3~0.5</small></div>
                        <div class="result-box"><div class="result-label">최소 필요 형체력</div><div class="result-value" id="cf-result">-- ton</div></div>
                    </div>
                </div>
            </div>

            <div id="page-melt-temp" class="page">
                <div class="page-header">
                    <h2 class="page-title">🌡️ 용융 온도 측정</h2>
                    <p class="page-desc">실제 용융 온도가 목표 범위 내에 있는지 확인합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적 및 절차</h3>
                    <div class="info-box"><h4>목적</h4><p>실제 용융 온도가 목표 범위 내에 있는지 확인합니다.</p></div>
                    <div class="info-box" style="margin-top:1rem;"><h4>절차</h4><p>1. 최소 30분 동안 기계 사이클 운전<br>2. 기계 정지 후 사출 유닛 후퇴<br>3. 배럴에서 플라스틱 퍼지<br>4. 프로브를 용융물 중앙에 삽입<br>5. 최고 온도 기록</p></div>
                </div>
                <div class="card">
                    <h3 class="card-title">🌡️ 온도 측정</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(3,1fr);">
                        <div class="form-group"><label class="form-label">목표 최저 온도 (°C)</label><input type="number" class="form-input" id="mt-low" oninput="calcMeltTemp()"></div>
                        <div class="form-group"><label class="form-label">목표 최고 온도 (°C)</label><input type="number" class="form-input" id="mt-high" oninput="calcMeltTemp()"></div>
                        <div class="form-group"><label class="form-label">실측 용융 온도 (°C)</label><input type="number" class="form-input" id="mt-actual" oninput="calcMeltTemp()"></div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📈 판정</h3>
                    <div class="result-box"><div class="result-label">용융 온도 상태</div><div class="result-value" id="mt-result">--</div><div id="mt-status"></div></div>
                </div>
            </div>

            <div id="page-fill-flow" class="page">
                <div class="page-header">
                    <h2 class="page-title">💧 충전 유량 연구</h2>
                    <p class="page-desc">모든 대상 기계에서 품질 좋은 제품을 생산하는 체적 유량을 결정합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적</h3>
                    <div class="info-box"><h4>목적</h4><p>모든 대상 기계에서 품질 좋은 제품을 생산하는 체적 유량(Volumetric Flow Rate)을 결정합니다.</p></div>
                </div>
                <div class="card">
                    <h3 class="card-title">🔧 기계 사양</h3>
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">스크류 직경 (mm)</label><input type="number" class="form-input" id="ff-screw-dia" step="0.1" oninput="calcFillFlowSpec()"></div>
                        <div class="form-group"><label class="form-label">스크류 면적 (mm²)</label><input type="number" class="form-input" id="ff-screw-area" readonly></div>
                        <div class="form-group"><label class="form-label">최대 선속도 (mm/s)</label><input type="number" class="form-input" id="ff-max-speed" oninput="calcFillFlowSpec()"></div>
                        <div class="form-group"><label class="form-label">최대 체적 유량 (cm³/s)</label><input type="number" class="form-input" id="ff-max-flow" readonly></div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 유량 테스트 데이터</h3>
                    <table class="data-table">
                        <thead><tr><th>샷 #</th><th>설정 속도 (mm/s)</th><th>충전 시간 (sec)</th><th>전환 압력 (MPa)</th><th>체적 유량 (cm³/s)</th><th>품질</th></tr></thead>
                        <tbody id="ff-table-body"></tbody>
                    </table>
                </div>
            </div>

            <div id="page-hold-time" class="page">
                <div class="page-header">
                    <h2 class="page-title">⏱️ 보압 시간 연구</h2>
                    <p class="page-desc">적절한 2단계(보압) 시간을 결정합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적 및 절차</h3>
                    <div class="info-box"><h4>목적</h4><p>적절한 2단계(보압) 시간을 결정합니다. 게이트 씰 시간은 부품 중량이 더 이상 증가하지 않는 시점입니다.</p></div>
                    <div class="formula-box"><strong>권장 최적 보압 시간:</strong> 게이트 씰 시간 + 1초</div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 보압 시간 테스트</h3>
                    <table class="data-table">
                        <thead><tr><th>샷 #</th><th>보압 시간 (sec)</th><th>부품 중량 (g)</th><th>중량 변화율 (%)</th></tr></thead>
                        <tbody id="ht-table-body"></tbody>
                    </table>
                </div>
                <div class="card">
                    <h3 class="card-title">📈 결과</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(2,1fr);">
                        <div class="result-box"><div class="result-label">추정 게이트 씰 시간</div><div class="result-value" id="ht-seal-time">-- sec</div></div>
                        <div class="result-box" style="border-color:var(--success);"><div class="result-label">권장 보압 시간</div><div class="result-value" id="ht-recommended" style="color:var(--success);">-- sec</div></div>
                    </div>
                </div>
            </div>

            <div id="page-cavity-imbalance" class="page">
                <div class="page-header">
                    <h2 class="page-title">⚖️ 캐비티 불균형 연구</h2>
                    <p class="page-desc">다수 캐비티 금형 내 불균형 정도를 측정합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적</h3>
                    <div class="info-box"><h4>목적</h4><p>다수 캐비티 금형 내 불균형 정도를 측정합니다.</p></div>
                    <div class="formula-box"><strong>계산식:</strong> 불균형률 (%) = (최대 중량 - 최소 중량) ÷ 평균 중량 × 100</div>
                </div>
                <div class="card">
                    <h3 class="card-title">⚙️ 판정 기준 설정</h3>
                    <div class="target-edit">
                        <label>⚠️ 목표 불균형률 (% 미만):</label>
                        <input type="number" id="ci-target" value="6" step="0.5" oninput="calcAllCavityImbalance()">
                        <span style="color:var(--text-secondary);">권장값: 6% 미만</span>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📝 기본 설정</h3>
                    <div class="form-group"><label class="form-label">캐비티 수</label><input type="number" class="form-input" id="ci-cavities" value="4" min="2" max="16" style="width:100px;" oninput="buildCITable()"></div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 고속 (Fast)</h3>
                    <table class="data-table" id="ci-fast-table"><thead><tr><th>캐비티 #</th><th>부품 중량 (g)</th></tr></thead><tbody></tbody></table>
                    <div class="result-box" style="margin-top:1rem;"><div class="result-label">고속 불균형률</div><div class="result-value" id="ci-fast-result">--%</div><div id="ci-fast-status"></div></div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 중속 (Medium)</h3>
                    <table class="data-table" id="ci-med-table"><thead><tr><th>캐비티 #</th><th>부품 중량 (g)</th></tr></thead><tbody></tbody></table>
                    <div class="result-box" style="margin-top:1rem;"><div class="result-label">중속 불균형률</div><div class="result-value" id="ci-med-result">--%</div><div id="ci-med-status"></div></div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 저속 (Slow)</h3>
                    <table class="data-table" id="ci-slow-table"><thead><tr><th>캐비티 #</th><th>부품 중량 (g)</th></tr></thead><tbody></tbody></table>
                    <div class="result-box" style="margin-top:1rem;"><div class="result-label">저속 불균형률</div><div class="result-value" id="ci-slow-result">--%</div><div id="ci-slow-status"></div></div>
                </div>
            </div>

            <div id="page-pressure-loss" class="page">
                <div class="page-header">
                    <h2 class="page-title">📉 동적 압력 손실 연구</h2>
                    <p class="page-desc">재료가 금형을 채우면서 발생하는 압력 손실을 측정합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적 및 절차</h3>
                    <div class="info-box">
                        <h4>목적</h4>
                        <p>재료가 금형을 채우면서 발생하는 압력 손실량을 측정합니다.</p>
                    </div>
                    <div class="info-box" style="margin-top:1rem;">
                        <h4>절차</h4>
                        <p>1. 성형조건(사출로 95~99%를 채우고 보압전환)공정 설정, 적절한 크기의 충전 전용 숏 확인<br>
                        2. 사출 유닛 후퇴, 보압 꺼짐<br>
                        3. 에어샷: 공기 중으로 충전 전용 숏 배출, 피크 V→P 압력 기록<br>
                        4. 스프루/러너: 스프루와 러너만 채우도록 숏 크기 조정, 피크 압력 기록<br>
                        5. 게이트 통과: 게이트 바로 안쪽까지만 채우도록 조정, 피크 압력 기록<br>
                        6. 충전 전용 숏: 원래 충전 전용 숏 크기로 조정, 피크 압력 기록</p>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 압력 손실 데이터 (MPa)</h3>
                    <table class="data-table">
                        <thead><tr><th>측정 위치</th><th>피크 V→P 압력</th><th>압력 손실</th><th>누적 압력</th><th>비율 (%)</th></tr></thead>
                        <tbody>
                            <tr><td>에어 샷 (노즐/배럴)</td><td><input type="number" id="pl-airshot" step="0.1" oninput="calcPressureLoss()"></td><td class="calc-cell">--</td><td class="calc-cell" id="pl-cum1">--</td><td class="calc-cell" id="pl-pct1">--</td></tr>
                            <tr><td>스프루/러너</td><td><input type="number" id="pl-sprue" step="0.1" oninput="calcPressureLoss()"></td><td class="calc-cell" id="pl-loss2">--</td><td class="calc-cell" id="pl-cum2">--</td><td class="calc-cell" id="pl-pct2">--</td></tr>
                            <tr><td>게이트</td><td><input type="number" id="pl-gates" step="0.1" oninput="calcPressureLoss()"></td><td class="calc-cell" id="pl-loss3">--</td><td class="calc-cell" id="pl-cum3">--</td><td class="calc-cell" id="pl-pct3">--</td></tr>
                            <tr><td>충전 완료 (캐비티)</td><td><input type="number" id="pl-fill" step="0.1" oninput="calcPressureLoss()"></td><td class="calc-cell" id="pl-loss4">--</td><td class="calc-cell" id="pl-cum4">--</td><td class="calc-cell" id="pl-pct4">--</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="page-cooling" class="page">
                <div class="page-header">
                    <h2 class="page-title">❄️ 냉각 시간 최적화</h2>
                    <p class="page-desc">최적의 냉각 시간을 결정합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적 및 절차</h3>
                    <div class="info-box">
                        <h4>목적</h4>
                        <p>최적의 냉각 시간을 결정합니다.</p>
                    </div>
                    <div class="info-box" style="margin-top:1rem;">
                        <h4>절차</h4>
                        <p>1. 완전 자동 모드로 부품 생산<br>
                        2. 이젝션 시 부품 온도 목표 범위 기록<br>
                        3. 부품의 가장 뜨거운(덜 냉각된) 부분 온도 측정<br>
                        4. 측정 온도가 목표 범위 내에 들어올 때까지 냉각 시간 조정<br>
                        5. 부품 치수가 요구 사양을 충족하는지 확인<br>
                        6. 최적화된 부품 온도 및 냉각 시간 기록</p>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">🌡️ 재료별 이젝션 온도</h3>
                    <div class="form-group"><label class="form-label">재료 선택</label>
                        <select class="form-select" id="co-material" style="width:300px;" onchange="updateCoolingRange()">
                            <option value="">재료 선택...</option>
                            <option value="ABS">ABS</option>
                            <option value="PA6">PA6 (나일론 6)</option>
                            <option value="PA66">PA66 (나일론 66)</option>
                            <option value="PC">PC (폴리카보네이트)</option>
                            <option value="PE-HD">PE-HD</option>
                            <option value="PE-LD">PE-LD</option>
                            <option value="PET">PET</option>
                            <option value="PMMA">PMMA (아크릴)</option>
                            <option value="POM">POM (아세탈)</option>
                            <option value="PP">PP</option>
                            <option value="PPS">PPS</option>
                            <option value="PS">PS</option>
                            <option value="PVC">PVC</option>
                        </select>
                    </div>
                    <div class="form-grid" style="grid-template-columns:repeat(3,1fr);">
                        <div><h4 style="color:var(--success);margin-bottom:1rem;">고정밀</h4><p id="co-high-range">--</p></div>
                        <div><h4 style="color:var(--warning);margin-bottom:1rem;">중정밀</h4><p id="co-med-range">--</p></div>
                        <div><h4 style="color:var(--accent);margin-bottom:1rem;">저정밀</h4><p id="co-low-range">--</p></div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 측정</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(2,1fr);">
                        <div class="form-group"><label class="form-label">원래 냉각 시간 (sec)</label><input type="number" class="form-input" id="co-original-time" step="0.1"></div>
                        <div class="form-group"><label class="form-label">원래 이젝션 온도 (°C)</label><input type="number" class="form-input" id="co-original-temp" oninput="checkCoolingTemp()"></div>
                    </div>
                    <div class="form-grid" style="grid-template-columns:repeat(2,1fr);margin-top:1rem;">
                        <div class="form-group"><label class="form-label">최적화 냉각 시간 (sec)</label><input type="number" class="form-input" id="co-optimized-time" step="0.1"></div>
                        <div class="form-group"><label class="form-label">최적화 이젝션 온도 (°C)</label><input type="number" class="form-input" id="co-actual" oninput="checkCoolingTemp()"></div>
                    </div>
                    <div class="result-box" style="margin-top:1rem;"><div class="result-label">판정 결과</div><div class="result-value" id="co-result">--</div><div id="co-status"></div></div>
                </div>
            </div>

            <div id="page-water-flow" class="page">
                <div class="page-header">
                    <h2 class="page-title">🌊 냉각수 유량 (레이놀즈 수)</h2>
                    <p class="page-desc">냉각 시스템 내 유동이 층류인지 난류인지 확인합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적 및 원리</h3>
                    <div class="info-box">
                        <h4>목적</h4>
                        <p>냉각 시스템 내 유동이 층류(Laminar)인지 난류(Turbulent)인지 확인합니다. 난류 유동이 열전달 효율이 높습니다.</p>
                    </div>
                    <div class="formula-box">
                        <strong>레이놀즈 수 계산식:</strong><br>
                        Re = (유속 × 직경) / 동점성 계수<br>
                        또는 Re = (21,200 × 유량(lpm)) / (직경(mm) × 동점성(cSt))
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">⚙️ 판정 기준 설정</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(2,1fr);">
                        <div class="target-edit">
                            <label>최소 Re (난류 시작):</label>
                            <input type="number" id="wf-min-target" value="4000" oninput="calcReynolds()">
                        </div>
                        <div class="target-edit">
                            <label>최대 Re (과도 난류):</label>
                            <input type="number" id="wf-max-target" value="8000" oninput="calcReynolds()">
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 레이놀즈 수 계산</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(4,1fr);">
                        <div class="form-group"><label class="form-label">유량 (lpm)</label><input type="number" class="form-input" id="wf-flow" step="0.1" oninput="calcReynolds()"></div>
                        <div class="form-group"><label class="form-label">채널 직경 (mm)</label><input type="number" class="form-input" id="wf-diameter" step="0.1" oninput="calcReynolds()"></div>
                        <div class="form-group"><label class="form-label">물 온도 (°C)</label><input type="number" class="form-input" id="wf-temp" value="20" oninput="calcReynolds()"></div>
                        <div class="form-group"><label class="form-label">동점성 계수 (cSt)</label><input type="number" class="form-input" id="wf-viscosity" readonly></div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📈 결과</h3>
                    <div class="result-box"><div class="result-label">레이놀즈 수 (Re)</div><div class="result-value" id="wf-reynolds">--</div><div id="wf-status"></div></div>
                    <div class="info-box"><h4>해석</h4><p>Re &lt; 2,300: 층류 ❌ | 2,300~4,000: 전이 ⚠️ | 4,000~8,000: 난류 ✅ | &gt; 8,000: 과도 난류 ⚠️</p></div>
                </div>
            </div>

            <div id="page-mold-deflection" class="page">
                <div class="page-header">
                    <h2 class="page-title">📏 금형 변형 연구</h2>
                    <p class="page-desc">보압 및 유지 중 금형 변형(휨)량을 측정합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">ℹ️ 목적 및 절차</h3>
                    <div class="info-box">
                        <h4>목적</h4>
                        <p>보압 및 유지 중 금형 변형(휨)량을 측정합니다. 결과는 금형 또는 공정 기록에 보관해야 합니다. 금형 무결성이 의심될 때마다 이 테스트를 수행해야 합니다.</p>
                    </div>
                    <div class="info-box" style="margin-top:1rem;">
                        <h4>절차</h4>
                        <p>1. 성형조건(사출로 95~99%를 채우고 보압전환)공정 설정<br>
                        2. 사출 유닛을 전진시켜 스프루 부싱에 접촉<br>
                        3. 인디케이터 설치 (마그네틱 베이스를 기계에 부착, 다이얼 인디케이터를 사출 유닛에 접촉)<br>
                        4. 전체 형체력으로 금형 클램핑, 전체 노즐 전진력 적용<br>
                        5. 인디케이터 영점 조정<br>
                        6. 5사이클 운전 후 보압 및 유지 중 금형 변형량 기록</p>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📊 변형 측정 데이터 (mm)</h3>
                    <table class="data-table">
                        <thead><tr><th>사이클 #</th><th>변형량 (mm)</th></tr></thead>
                        <tbody>
                            <tr><td>1</td><td><input type="number" id="md-d1" step="0.001" oninput="calcMoldDeflection()"></td></tr>
                            <tr><td>2</td><td><input type="number" id="md-d2" step="0.001" oninput="calcMoldDeflection()"></td></tr>
                            <tr><td>3</td><td><input type="number" id="md-d3" step="0.001" oninput="calcMoldDeflection()"></td></tr>
                            <tr><td>4</td><td><input type="number" id="md-d4" step="0.001" oninput="calcMoldDeflection()"></td></tr>
                            <tr><td>5</td><td><input type="number" id="md-d5" step="0.001" oninput="calcMoldDeflection()"></td></tr>
                        </tbody>
                    </table>
                </div>
                <div class="card">
                    <h3 class="card-title">📈 결과</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(3,1fr);">
                        <div class="result-box"><div class="result-label">평균 변형량</div><div class="result-value" id="md-avg">--</div></div>
                        <div class="result-box"><div class="result-label">최대 변형량</div><div class="result-value" id="md-max">--</div></div>
                        <div class="result-box"><div class="result-label">최소 변형량</div><div class="result-value" id="md-min">--</div></div>
                    </div>
                </div>
            </div>

            <div id="page-roi" class="page">
                <div class="page-header">
                    <h2 class="page-title">💰 투자 수익률 (ROI) 계산</h2>
                    <p class="page-desc">사이클 타임 개선으로 인한 비용 절감을 계산합니다.</p>
                </div>
                <div class="card">
                    <h3 class="card-title">📝 기본 정보</h3>
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">파트 명칭</label><input type="text" class="form-input" id="roi-part-name"></div>
                        <div class="form-group"><label class="form-label">연간 생산량</label><input type="number" class="form-input" id="roi-annual-volume" oninput="calcROI()"></div>
                        <div class="form-group"><label class="form-label">통화</label><select class="form-select" id="roi-currency" onchange="calcROI()"><option value="₩">₩ (원)</option><option value="$">$ (달러)</option></select></div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">⏱️ 사이클 타임</h3>
                    <div class="form-grid" style="grid-template-columns:1fr 1fr;">
                        <div style="background:rgba(220,53,69,0.1);padding:1rem;border-radius:8px;">
                            <h4 style="color:var(--danger);margin-bottom:1rem;">현재 (Before)</h4>
                            <div class="form-group"><label class="form-label">사이클 타임 (sec)</label><input type="number" class="form-input" id="roi-current-cycle" step="0.1" oninput="calcROI()"></div>
                            <div class="form-group"><label class="form-label">부품당 재료비</label><input type="number" class="form-input" id="roi-current-material" step="0.01" oninput="calcROI()"></div>
                        </div>
                        <div style="background:rgba(40,167,69,0.1);padding:1rem;border-radius:8px;">
                            <h4 style="color:var(--success);margin-bottom:1rem;">개선 후 (After)</h4>
                            <div class="form-group"><label class="form-label">사이클 타임 (sec)</label><input type="number" class="form-input" id="roi-new-cycle" step="0.1" oninput="calcROI()"></div>
                            <div class="form-group"><label class="form-label">부품당 재료비</label><input type="number" class="form-input" id="roi-new-material" step="0.01" oninput="calcROI()"></div>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">💵 비용 정보</h3>
                    <div class="form-grid">
                        <div class="form-group"><label class="form-label">시간당 기계비</label><input type="number" class="form-input" id="roi-machine-rate" oninput="calcROI()"></div>
                        <div class="form-group"><label class="form-label">시간당 인건비</label><input type="number" class="form-input" id="roi-labor-rate" oninput="calcROI()"></div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">📈 절감 효과</h3>
                    <div class="form-grid" style="grid-template-columns:repeat(2,1fr);">
                        <div class="result-box"><div class="result-label">사이클 타임 절감</div><div class="result-value" id="roi-cycle-savings">--</div></div>
                        <div class="result-box"><div class="result-label">연간 시간 절감</div><div class="result-value" id="roi-time-savings">--</div></div>
                    </div>
                    <div class="result-box" style="margin-top:1rem;border-color:var(--success);"><div class="result-label">총 연간 절감액</div><div class="result-value" id="roi-total-savings" style="color:var(--success);font-size:2.5rem;">--</div></div>
                </div>
            </div>
        </main>
    </div>
    <script>
// 모바일 사이드바 제어
function openSidebar() {
    document.getElementById('sidebar').classList.add('open');
    document.getElementById('sidebar-overlay').classList.add('active');
    document.body.style.overflow = 'hidden';
}

function closeSidebar() {
    document.getElementById('sidebar').classList.remove('open');
    document.getElementById('sidebar-overlay').classList.remove('active');
    document.body.style.overflow = '';
}

// THEME TOGGLE (다크/라이트) - 계산/옵션 로직은 건드리지 않고 UI 색상만 반전
const THEME_KEY = 'moldflow_helpdesk_theme_v1';

function cssVar(name){
    return getComputedStyle(document.body).getPropertyValue(name).trim();
}

function updateThemeToggleLabel(){
    const btn = document.getElementById('theme-toggle');
    if(!btn) return;
    const isLight = document.body.classList.contains('light-mode');
    btn.textContent = isLight ? '🌙 어둡게' : '🌞 밝게';
    btn.setAttribute('aria-pressed', isLight ? 'true' : 'false');
}

function applyChartTheme(){
    // Fill Control 차트 텍스트/그리드 색상만 테마에 맞춰 동기화
    try{
        if (typeof fillChart !== 'undefined' && fillChart) {
            const border = cssVar('--border') || '#d1d5db';
            const textSecondary = cssVar('--text-secondary') || '#4b5563';
            const textPrimary = cssVar('--text-primary') || '#111827';

            if(fillChart.options?.scales?.x?.grid) fillChart.options.scales.x.grid.color = border;
            if(fillChart.options?.scales?.y?.grid) fillChart.options.scales.y.grid.color = border;
            if(fillChart.options?.scales?.x?.ticks) fillChart.options.scales.x.ticks.color = textSecondary;
            if(fillChart.options?.scales?.y?.ticks) fillChart.options.scales.y.ticks.color = textSecondary;
            if(fillChart.options?.plugins?.legend?.labels) fillChart.options.plugins.legend.labels.color = textPrimary;

            fillChart.update();
        }
    }catch(e){}
}

function setTheme(mode){
    const isLight = (mode === 'light');
    document.body.classList.toggle('light-mode', isLight);
    localStorage.setItem(THEME_KEY, isLight ? 'light' : 'dark');
    updateThemeToggleLabel();
    applyChartTheme();
}

function toggleTheme(){
    const isLight = document.body.classList.contains('light-mode');
    setTheme(isLight ? 'dark' : 'light');
}

document.addEventListener('DOMContentLoaded', () => {
    const saved = localStorage.getItem(THEME_KEY);
    if (saved === 'light') document.body.classList.add('light-mode');
    updateThemeToggleLabel();
    applyChartTheme();
});

        // LOGIN SECURITY LOGIC
        const ACCESS_CODE = "EDNC2026"; // 초기 비밀번호 설정
        
        function tryLogin() {
            const input = document.getElementById('login-pw');
            const overlay = document.getElementById('login-overlay');
            const main = document.getElementById('main-app');
            const error = document.getElementById('login-error');
            
            if (input.value === ACCESS_CODE) {
                overlay.style.opacity = '0';
                setTimeout(() => {
                    overlay.style.display = 'none';
                    main.style.filter = 'none';
                    document.body.style.overflowX = 'auto'; // 스크롤 허용
                }, 500);
                // 로그인 유지 (선택사항: 세션 동안만 유지)
                sessionStorage.setItem('isLoggedIn', 'true');
            } else {
                error.style.display = 'block';
                input.value = '';
                input.focus();
            }
        }

        function doLogout() {
            if(confirm('로그아웃 하시겠습니까?')) {
                sessionStorage.removeItem('isLoggedIn');
                location.reload();
            }
        }

        // 자동 로그인 체크 (세션 스토리지 사용)
        document.addEventListener("DOMContentLoaded", () => {
            if(sessionStorage.getItem('isLoggedIn') === 'true') {
                document.getElementById('login-overlay').style.display = 'none';
                document.getElementById('main-app').style.filter = 'none';
            }
        });

        // Navigation
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                navigateTo(item.dataset.page);
                closeSidebar(); // 모바일에서 메뉴 선택 후 사이드바 닫기
            });
        });
        function navigateTo(page) {
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelector('[data-page="'+page+'"]').classList.add('active');
            document.getElementById('page-'+page).classList.add('active');
            window.scrollTo(0, 0); // 페이지 상단으로 스크롤
        }

        // Metering Calculator
        function calcMetering() {
            const volume = parseFloat(document.getElementById('mc-volume').value) || 0;
            const cavities = parseInt(document.getElementById('mc-cavities').value) || 1;
            const runner = parseFloat(document.getElementById('mc-runner').value) || 0;
            const solidDensity = parseFloat(document.getElementById('mc-solid-density').value) || 1;
            const meltDensity = parseFloat(document.getElementById('mc-melt-density').value) || 1;
            const pvt = parseFloat(document.getElementById('mc-pvt').value) || 1;
            const screwDia = parseFloat(document.getElementById('mc-screw-dia').value) || 1;
            const efficiency = parseFloat(document.getElementById('mc-efficiency').value) / 100 || 0.95;
            const cushion = parseFloat(document.getElementById('mc-cushion').value) || 5;

            const totalVolume = (volume * cavities) + runner;
            const shotWeight = totalVolume * solidDensity;
            const meltVolume = (shotWeight / meltDensity) * pvt;
            const screwArea = Math.PI * Math.pow(screwDia / 2, 2);
            const theoryStroke = (meltVolume * 1000) / screwArea;
            const actualMetering = theoryStroke / efficiency;
            const recommended = actualMetering + cushion;

            document.getElementById('mc-total-volume').textContent = totalVolume.toFixed(2);
            document.getElementById('mc-shot-weight').textContent = shotWeight.toFixed(2);
            document.getElementById('mc-melt-volume').textContent = meltVolume.toFixed(2);
            document.getElementById('mc-screw-area').textContent = screwArea.toFixed(2);
            document.getElementById('mc-theory-stroke').textContent = theoryStroke.toFixed(2);
            document.getElementById('mc-actual-metering').textContent = actualMetering.toFixed(2);
            document.getElementById('mc-recommended').textContent = recommended.toFixed(2);
        }

        // Fill Control Calculator
        let fillChart = null;
        function calcFillControl() {
            const metering = parseFloat(document.getElementById('fc-metering').value) || 80;
            const screwDia = parseFloat(document.getElementById('fc-screw-dia').value) || 45;
            const vpPosition = parseFloat(document.getElementById('fc-vp-position').value) || 10;
            const screwArea = Math.PI * Math.pow(screwDia / 2, 2) / 100; // cm²

            // Update linked positions
            document.getElementById('fc-pos1-start').value = metering;
            const pos1End = parseFloat(document.getElementById('fc-pos1-end').value);
            document.getElementById('fc-pos2-start').value = pos1End;
            const pos2End = parseFloat(document.getElementById('fc-pos2-end').value);
            document.getElementById('fc-pos3-start').value = pos2End;
            const pos3End = parseFloat(document.getElementById('fc-pos3-end').value);
            document.getElementById('fc-pos4-start').value = pos3End;
            document.getElementById('fc-pos4-end').value = vpPosition;

            const speeds = [
                parseFloat(document.getElementById('fc-speed1').value) || 0,
                parseFloat(document.getElementById('fc-speed2').value) || 0,
                parseFloat(document.getElementById('fc-speed3').value) || 0,
                parseFloat(document.getElementById('fc-speed4').value) || 0
            ];
            const positions = [
                [metering, pos1End],
                [pos1End, pos2End],
                [pos2End, pos3End],
                [pos3End, vpPosition]
            ];

            let totalStroke = 0, totalVolume = 0, totalTime = 0;
            for (let i = 0; i < 4; i++) {
                const dist = positions[i][0] - positions[i][1];
                const vol = dist * screwArea / 10;
                const time = speeds[i] > 0 ? dist / speeds[i] : 0;
                const flow = time > 0 ? vol / time : 0;

                document.getElementById('fc-dist'+(i+1)).textContent = dist.toFixed(2);
                document.getElementById('fc-vol'+(i+1)).textContent = vol.toFixed(2);
                document.getElementById('fc-time'+(i+1)).textContent = time.toFixed(3);
                document.getElementById('fc-flow'+(i+1)).textContent = flow.toFixed(2);

                totalStroke += dist;
                totalVolume += vol;
                totalTime += time;
            }

            document.getElementById('fc-total-stroke').textContent = totalStroke.toFixed(2);
            document.getElementById('fc-total-volume').textContent = totalVolume.toFixed(2);
            document.getElementById('fc-avg-speed').textContent = totalTime > 0 ? (totalStroke / totalTime).toFixed(2) : '--';
            document.getElementById('fc-calc-time').textContent = totalTime.toFixed(3);

            // Draw chart
            drawFillChart(positions, speeds);
        }

        function drawFillChart(positions, speeds) {
            const ctx = document.getElementById('fillProfileChart');
            if (!ctx) return;

            const data = [];
            let currentPos = positions[0][0];
            data.push({x: currentPos, y: speeds[0]});
            for (let i = 0; i < 4; i++) {
                data.push({x: positions[i][1], y: speeds[i]});
                if (i < 3) data.push({x: positions[i][1], y: speeds[i+1]});
            }

            if (fillChart) fillChart.destroy();
            fillChart = new Chart(ctx, {
                type: 'line',
                data: {
                    datasets: [{
                        label: '속도 프로파일',
                        data: data,
                        borderColor: '#ff6b35',
                        backgroundColor: 'rgba(255, 107, 53, 0.2)',
                        fill: true,
                        stepped: true,
                        tension: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            type: 'linear',
                            reverse: true,
                            title: { display: true, text: '스크류 위치 (mm)', color: '#8899aa' },
                            grid: { color: cssVar('--border') },
                            ticks: { color: cssVar('--text-secondary') }
                        },
                        y: {
                            title: { display: true, text: '사출 속도 (mm/s)', color: '#8899aa' },
                            grid: { color: cssVar('--border') },
                            ticks: { color: cssVar('--text-secondary') },
                            beginAtZero: true
                        }
                    },
                    plugins: {
                        legend: { labels: { color: cssVar('--text-primary') } }
                    }
                }
            });
        }

        // Speed Linearity
        function initSpeedLinearityTable() {
            const tbody = document.getElementById('sl-table-body');
            tbody.innerHTML = '';
            for (let i = 1; i <= 10; i++) {
                tbody.innerHTML += '<tr><td>'+i+'</td><td><input type="number" id="sl-speed-'+i+'" step="1" oninput="calcSpeedLinearity()"></td><td><input type="number" id="sl-time-'+i+'" step="0.001" oninput="calcSpeedLinearity()"></td><td class="calc-cell" id="sl-expected-'+i+'">--</td><td class="calc-cell" id="sl-actual-'+i+'">--</td><td class="result-cell" id="sl-change-'+i+'">--</td><td id="sl-status-'+i+'">--</td></tr>';
            }
        }

        function calcSpeedLinearity() {
            const stroke = parseFloat(document.getElementById('sl-stroke').value);
            const target = parseFloat(document.getElementById('sl-target').value) || 5;
            if (!stroke) return;

            let passCount = 0, failCount = 0;
            for (let i = 1; i <= 10; i++) {
                const speed = parseFloat(document.getElementById('sl-speed-'+i).value);
                const time = parseFloat(document.getElementById('sl-time-'+i).value);
                if (speed && stroke) document.getElementById('sl-expected-'+i).textContent = (stroke / speed).toFixed(3);
                if (time && stroke && speed) {
                    const actual = stroke / time;
                    const change = ((actual - speed) / speed) * 100;
                    document.getElementById('sl-actual-'+i).textContent = actual.toFixed(3);
                    document.getElementById('sl-change-'+i).textContent = change.toFixed(2) + '%';
                    if (Math.abs(change) <= target) {
                        document.getElementById('sl-status-'+i).innerHTML = '<span class="status status-pass">✓</span>';
                        passCount++;
                    } else {
                        document.getElementById('sl-status-'+i).innerHTML = '<span class="status status-fail">✗</span>';
                        failCount++;
                    }
                }
            }
            document.getElementById('sl-pass-count').textContent = passCount;
            document.getElementById('sl-fail-count').textContent = failCount;
            document.getElementById('sl-overall-status').innerHTML = failCount === 0 && passCount > 0 ? '<span class="status status-pass">합격</span>' : '<span class="status status-fail">불합격</span>';
        }

        // Load Sensitivity
        function calcLoadSensitivity() {
            const moldTime = parseFloat(document.getElementById('ls-mold-fill-time').value);
            const moldPressure = parseFloat(document.getElementById('ls-mold-peak-pressure').value);
            const airTime = parseFloat(document.getElementById('ls-air-fill-time').value);
            const airPressure = parseFloat(document.getElementById('ls-air-peak-pressure').value);
            const timeTarget = parseFloat(document.getElementById('ls-time-target').value) || 5;
            const pressureTarget = parseFloat(document.getElementById('ls-pressure-target').value) || 7.25;

            if (moldTime && airTime) {
                const tc = ((moldTime - airTime) / airTime) * 100;
                document.getElementById('ls-time-change').textContent = tc.toFixed(2) + '%';
                document.getElementById('ls-time-status').innerHTML = Math.abs(tc) <= timeTarget ? '<span class="status status-pass">✓ 합격</span>' : '<span class="status status-fail">✗ 불합격</span>';
            }
            if (moldPressure && airPressure) {
                const pc = ((moldPressure - airPressure) / airPressure) * 100;
                document.getElementById('ls-pressure-change').textContent = pc.toFixed(2) + '%';
                document.getElementById('ls-pressure-status').innerHTML = Math.abs(pc) <= pressureTarget ? '<span class="status status-pass">✓ 합격</span>' : '<span class="status status-fail">✗ 불합격</span>';
            }
        }

        // Check Ring
        function calcCheckRing() {
            const target = parseFloat(document.getElementById('cr-target').value) || 3;
            const weights = [];
            for (let i = 1; i <= 10; i++) { const w = parseFloat(document.getElementById('cr-w'+i).value); if (w) weights.push(w); }
            if (weights.length > 0) {
                const avg = weights.reduce((a, b) => a + b, 0) / weights.length;
                const max = Math.max(...weights), min = Math.min(...weights);
                const variation = ((max - min) / avg) * 100;
                document.getElementById('cr-avg').textContent = avg.toFixed(3);
                document.getElementById('cr-max').textContent = max.toFixed(3);
                document.getElementById('cr-min').textContent = min.toFixed(3);
                document.getElementById('cr-variation').textContent = variation.toFixed(2) + '%';
                document.getElementById('cr-status').innerHTML = variation <= target ? '<span class="status status-pass">✓ 합격</span>' : '<span class="status status-fail">✗ 불합격</span>';
            }
        }

        // Pressure Response
        function calcPressureResponse() {
            const t1 = parseFloat(document.getElementById('pr-t1').value);
            const t2 = parseFloat(document.getElementById('pr-t2').value);
            const target = parseFloat(document.getElementById('pr-target').value) || 0.20;
            if (t1 !== undefined && t2 !== undefined && !isNaN(t1) && !isNaN(t2)) {
                const diff = t2 - t1;
                document.getElementById('pr-time-diff').textContent = diff.toFixed(3) + ' sec';
                document.getElementById('pr-index').textContent = diff.toFixed(3);
                document.getElementById('pr-status').innerHTML = diff <= target ? '<span class="status status-pass">✓ 합격</span>' : '<span class="status status-fail">✗ 불합격</span>';
            }
        }

        // Platen Deflection
        function calcPlatenDeflection() {
            const deflections = [];
            for (let i = 1; i <= 5; i++) { const d = parseFloat(document.getElementById('pd-d'+i).value); if (!isNaN(d)) deflections.push(d); }
            if (deflections.length > 0) {
                const avg = deflections.reduce((a, b) => a + b, 0) / deflections.length;
                document.getElementById('pd-avg').textContent = avg.toFixed(4);
                document.getElementById('pd-max').textContent = Math.max(...deflections).toFixed(4);
                document.getElementById('pd-min').textContent = Math.min(...deflections).toFixed(4);
            }
        }

        // Clamp Force
        function calcClampForce() {
            let totalArea = 0;
            for (let i = 1; i <= 3; i++) {
                const shape = parseFloat(document.getElementById('cf-shape'+i).value) || 0;
                const shut = parseFloat(document.getElementById('cf-shut'+i).value) || 0;
                const qty = parseInt(document.getElementById('cf-qty'+i).value) || 1;
                const area = (shape - shut) * qty;
                document.getElementById('cf-area'+i).textContent = area > 0 ? area.toFixed(2) : '--';
                if (area > 0) totalArea += area;
            }
            document.getElementById('cf-total-area').textContent = totalArea > 0 ? totalArea.toFixed(2) : '--';
            const totalAreaCm2 = totalArea / 100;
            document.getElementById('cf-proj-area').value = totalAreaCm2 > 0 ? totalAreaCm2.toFixed(2) : '';
            const tonnageFactor = parseFloat(document.getElementById('cf-tonnage-factor').value) || 0;
            if (totalAreaCm2 > 0 && tonnageFactor) {
                document.getElementById('cf-result').textContent = (totalAreaCm2 * tonnageFactor).toFixed(1) + ' ton';
            }
        }

        // Melt Temp
        function calcMeltTemp() {
            const low = parseFloat(document.getElementById('mt-low').value);
            const high = parseFloat(document.getElementById('mt-high').value);
            const actual = parseFloat(document.getElementById('mt-actual').value);
            if (low && high && actual) {
                document.getElementById('mt-result').textContent = actual + '°C';
                if (actual >= low && actual <= high) document.getElementById('mt-status').innerHTML = '<span class="status status-pass">✓ 범위 내</span>';
                else if (actual < low) document.getElementById('mt-status').innerHTML = '<span class="status status-fail">✗ 목표 미만</span>';
                else document.getElementById('mt-status').innerHTML = '<span class="status status-warning">⚠ 목표 초과</span>';
            }
        }

        // Fill Flow
        function calcFillFlowSpec() {
            const dia = parseFloat(document.getElementById('ff-screw-dia').value);
            if (dia) {
                const area = Math.PI * Math.pow(dia / 2, 2);
                document.getElementById('ff-screw-area').value = area.toFixed(2);
                const maxSpeed = parseFloat(document.getElementById('ff-max-speed').value);
                if (maxSpeed) document.getElementById('ff-max-flow').value = (area * maxSpeed / 1000).toFixed(2);
            }
        }

        function initFillFlowTable() {
            const tbody = document.getElementById('ff-table-body');
            tbody.innerHTML = '';
            for (let i = 1; i <= 10; i++) {
                tbody.innerHTML += '<tr><td>'+i+'</td><td><input type="number" id="ff-speed-'+i+'" oninput="calcFillFlowRow('+i+')"></td><td><input type="number" id="ff-time-'+i+'" step="0.001" oninput="calcFillFlowRow('+i+')"></td><td><input type="number" id="ff-pressure-'+i+'" step="0.1"></td><td class="calc-cell" id="ff-flow-'+i+'">--</td><td><select id="ff-quality-'+i+'"><option value="">선택</option><option value="good">양호</option><option value="short">미성형</option><option value="flash">버</option></select></td></tr>';
            }
        }

        function calcFillFlowRow(row) {
            const area = parseFloat(document.getElementById('ff-screw-area').value) || 0;
            const speed = parseFloat(document.getElementById('ff-speed-'+row).value) || 0;
            if (area && speed) {
                const flow = area * speed / 1000;
                document.getElementById('ff-flow-'+row).textContent = flow.toFixed(2);
            }
        }

        // Hold Time
        function initHoldTimeTable() {
            const tbody = document.getElementById('ht-table-body');
            tbody.innerHTML = '';
            for (let i = 1; i <= 10; i++) {
                tbody.innerHTML += '<tr><td>'+i+'</td><td><input type="number" id="ht-time-'+i+'" step="0.1" oninput="calcHoldTime()"></td><td><input type="number" id="ht-weight-'+i+'" step="0.001" oninput="calcHoldTime()"></td><td class="calc-cell" id="ht-change-'+i+'">--</td></tr>';
            }
        }

        function calcHoldTime() {
            let prevWeight = null, sealTime = null;
            for (let i = 1; i <= 10; i++) {
                const time = parseFloat(document.getElementById('ht-time-'+i).value);
                const weight = parseFloat(document.getElementById('ht-weight-'+i).value);
                if (weight && prevWeight) {
                    const change = ((weight - prevWeight) / prevWeight) * 100;
                    document.getElementById('ht-change-'+i).textContent = change.toFixed(2) + '%';
                    if (Math.abs(change) < 1 && !sealTime && time) sealTime = time;
                }
                if (weight) prevWeight = weight;
            }
            document.getElementById('ht-seal-time').textContent = sealTime ? sealTime + ' sec' : '-- sec';
            document.getElementById('ht-recommended').textContent = sealTime ? (sealTime + 1) + ' sec' : '-- sec';
        }

        // Cavity Imbalance
        function buildCITable() {
            const cavities = parseInt(document.getElementById('ci-cavities').value) || 4;
            ['fast', 'med', 'slow'].forEach(speed => {
                const tbody = document.querySelector('#ci-'+speed+'-table tbody');
                tbody.innerHTML = '';
                for (let i = 1; i <= cavities; i++) {
                    tbody.innerHTML += '<tr><td>'+i+'</td><td><input type="number" id="ci-'+speed+'-'+i+'" step="0.001" oninput="calcCavityImbalance(\''+speed+'\')"></td></tr>';
                }
            });
        }

        function calcCavityImbalance(speed) {
            const cavities = parseInt(document.getElementById('ci-cavities').value) || 4;
            const target = parseFloat(document.getElementById('ci-target').value) || 6;
            const weights = [];
            for (let i = 1; i <= cavities; i++) { const w = parseFloat(document.getElementById('ci-'+speed+'-'+i).value); if (w) weights.push(w); }
            if (weights.length >= 2) {
                const avg = weights.reduce((a, b) => a + b, 0) / weights.length;
                const imbalance = ((Math.max(...weights) - Math.min(...weights)) / avg) * 100;
                document.getElementById('ci-'+speed+'-result').textContent = imbalance.toFixed(2) + '%';
                document.getElementById('ci-'+speed+'-status').innerHTML = imbalance < target ? '<span class="status status-pass">✓ 합격</span>' : '<span class="status status-fail">✗ 불합격</span>';
            }
        }

        function calcAllCavityImbalance() {
            ['fast', 'med', 'slow'].forEach(speed => calcCavityImbalance(speed));
        }

        // Pressure Loss
        function calcPressureLoss() {
            const airshot = parseFloat(document.getElementById('pl-airshot').value);
            const sprue = parseFloat(document.getElementById('pl-sprue').value);
            const gates = parseFloat(document.getElementById('pl-gates').value);
            const fill = parseFloat(document.getElementById('pl-fill').value);

            document.getElementById('pl-cum1').textContent = airshot ? airshot.toFixed(1) : '--';
            if (airshot && sprue) { document.getElementById('pl-loss2').textContent = (sprue - airshot).toFixed(1); document.getElementById('pl-cum2').textContent = sprue.toFixed(1); }
            if (sprue && gates) { document.getElementById('pl-loss3').textContent = (gates - sprue).toFixed(1); document.getElementById('pl-cum3').textContent = gates.toFixed(1); }
            if (gates && fill) { document.getElementById('pl-loss4').textContent = (fill - gates).toFixed(1); document.getElementById('pl-cum4').textContent = fill.toFixed(1); }
            if (airshot && fill) {
                document.getElementById('pl-pct1').textContent = ((airshot / fill) * 100).toFixed(1) + '%';
                if (sprue) document.getElementById('pl-pct2').textContent = (((sprue - airshot) / fill) * 100).toFixed(1) + '%';
                if (gates) document.getElementById('pl-pct3').textContent = (((gates - sprue) / fill) * 100).toFixed(1) + '%';
                if (fill) document.getElementById('pl-pct4').textContent = (((fill - gates) / fill) * 100).toFixed(1) + '%';
            }
        }

        // Cooling
        const coolingData = {
            'ABS': { high: [65, 75], med: [75, 85], low: [85, 95] },
            'PA6': { high: [80, 100], med: [100, 120], low: [120, 140] },
            'PA66': { high: [80, 100], med: [100, 120], low: [120, 140] },
            'PC': { high: [100, 115], med: [115, 130], low: [130, 145] },
            'PE-HD': { high: [60, 70], med: [70, 80], low: [80, 90] },
            'PE-LD': { high: [50, 60], med: [60, 70], low: [70, 80] },
            'PET': { high: [70, 90], med: [90, 110], low: [110, 130] },
            'PMMA': { high: [70, 80], med: [80, 90], low: [90, 100] },
            'POM': { high: [90, 110], med: [110, 130], low: [130, 150] },
            'PP': { high: [70, 85], med: [85, 100], low: [100, 115] },
            'PPS': { high: [120, 140], med: [140, 160], low: [160, 180] },
            'PS': { high: [60, 70], med: [70, 80], low: [80, 90] },
            'PVC': { high: [50, 60], med: [60, 70], low: [70, 80] }
        };

        function updateCoolingRange() {
            const material = document.getElementById('co-material').value;
            if (material && coolingData[material]) {
                const d = coolingData[material];
                document.getElementById('co-high-range').textContent = d.high[0] + ' ~ ' + d.high[1] + '°C';
                document.getElementById('co-med-range').textContent = d.med[0] + ' ~ ' + d.med[1] + '°C';
                document.getElementById('co-low-range').textContent = d.low[0] + ' ~ ' + d.low[1] + '°C';
            }
        }

        function checkCoolingTemp() {
            const material = document.getElementById('co-material').value;
            const actual = parseFloat(document.getElementById('co-actual').value);
            if (material && coolingData[material] && actual) {
                const d = coolingData[material];
                if (actual >= d.high[0] && actual <= d.high[1]) { document.getElementById('co-result').textContent = '고정밀'; document.getElementById('co-status').innerHTML = '<span class="status status-pass">✓ 최적</span>'; }
                else if (actual >= d.med[0] && actual <= d.med[1]) { document.getElementById('co-result').textContent = '중정밀'; document.getElementById('co-status').innerHTML = '<span class="status status-warning">⚠ 양호</span>'; }
                else if (actual >= d.low[0] && actual <= d.low[1]) { document.getElementById('co-result').textContent = '저정밀'; document.getElementById('co-status').innerHTML = '<span class="status status-warning">⚠ 허용</span>'; }
                else { document.getElementById('co-result').textContent = '범위 초과'; document.getElementById('co-status').innerHTML = '<span class="status status-fail">✗ 조정 필요</span>'; }
            }
        }

        // Reynolds
        function calcReynolds() {
            const flow = parseFloat(document.getElementById('wf-flow').value);
            const diameter = parseFloat(document.getElementById('wf-diameter').value);
            const temp = parseFloat(document.getElementById('wf-temp').value);
            const minTarget = parseFloat(document.getElementById('wf-min-target').value) || 4000;
            const maxTarget = parseFloat(document.getElementById('wf-max-target').value) || 8000;

            const viscosityData = { 5: 1.519, 10: 1.307, 15: 1.139, 20: 1.004, 25: 0.893, 30: 0.801, 40: 0.658, 50: 0.553, 60: 0.475 };
            let viscosity = 1.004;
            const temps = Object.keys(viscosityData).map(Number).sort((a, b) => a - b);
            for (let i = 0; i < temps.length - 1; i++) {
                if (temp >= temps[i] && temp <= temps[i + 1]) {
                    const t1 = temps[i], t2 = temps[i + 1];
                    viscosity = viscosityData[t1] + (viscosityData[t2] - viscosityData[t1]) * (temp - t1) / (t2 - t1);
                    break;
                }
            }
            document.getElementById('wf-viscosity').value = viscosity.toFixed(3);
            if (flow && diameter && viscosity) {
                const re = (21200 * flow) / (diameter * viscosity);
                document.getElementById('wf-reynolds').textContent = Math.round(re).toLocaleString();
                let status = '';
                if (re < 2300) status = '<span class="status status-fail">층류 - 냉각 효율 낮음</span>';
                else if (re < minTarget) status = '<span class="status status-warning">전이 영역</span>';
                else if (re <= maxTarget) status = '<span class="status status-pass">난류 - 최적</span>';
                else status = '<span class="status status-warning">과도 난류</span>';
                document.getElementById('wf-status').innerHTML = status;
            }
        }

        // Mold Deflection
        function calcMoldDeflection() {
            const deflections = [];
            for (let i = 1; i <= 5; i++) { const d = parseFloat(document.getElementById('md-d'+i).value); if (!isNaN(d)) deflections.push(d); }
            if (deflections.length > 0) {
                const avg = deflections.reduce((a, b) => a + b, 0) / deflections.length;
                document.getElementById('md-avg').textContent = avg.toFixed(4);
                document.getElementById('md-max').textContent = Math.max(...deflections).toFixed(4);
                document.getElementById('md-min').textContent = Math.min(...deflections).toFixed(4);
            }
        }

        // ROI
        function calcROI() {
            const currency = document.getElementById('roi-currency').value;
            const annualVolume = parseFloat(document.getElementById('roi-annual-volume').value) || 0;
            const currentCycle = parseFloat(document.getElementById('roi-current-cycle').value) || 0;
            const newCycle = parseFloat(document.getElementById('roi-new-cycle').value) || 0;
            const currentMaterial = parseFloat(document.getElementById('roi-current-material').value) || 0;
            const newMaterial = parseFloat(document.getElementById('roi-new-material').value) || 0;
            const machineRate = parseFloat(document.getElementById('roi-machine-rate').value) || 0;
            const laborRate = parseFloat(document.getElementById('roi-labor-rate').value) || 0;
            if (currentCycle && newCycle && annualVolume) {
                const cycleSavings = currentCycle - newCycle;
                const currentHours = (annualVolume * currentCycle) / 3600;
                const newHours = (annualVolume * newCycle) / 3600;
                const timeSavings = currentHours - newHours;
                const totalSavings = (timeSavings * machineRate) + (timeSavings * laborRate) + (annualVolume * (currentMaterial - newMaterial));

                document.getElementById('roi-cycle-savings').textContent = cycleSavings.toFixed(2) + ' sec (' + ((cycleSavings/currentCycle)*100).toFixed(1) + '%)';
                document.getElementById('roi-time-savings').textContent = timeSavings.toFixed(1) + ' hr';
                document.getElementById('roi-total-savings').textContent = currency + ' ' + totalSavings.toLocaleString(undefined, { maximumFractionDigits: 0 });
            }
        }

        // Reset
        function resetAllData() {
            if (confirm('모든 데이터를 초기화하시겠습니까?')) {
                document.querySelectorAll('input[type="number"], input[type="text"], textarea').forEach(input => { if (!input.readOnly && !input.classList.contains('editable-target')) input.value = ''; });
                location.reload();
            }
        }

// Initialize
        document.addEventListener('DOMContentLoaded', () => {
            // [1] 사용 기한 체크 (Expiration Check)
            checkExpiration(); 

            // [2] 기존 초기화 로직
            initSpeedLinearityTable();
            initFillFlowTable();
            initHoldTimeTable();
            buildCITable();
            calcMetering();
            calcFillControl();
            const today = new Date().toISOString().split('T')[0];
            document.querySelectorAll('input[type="date"]').forEach(input => { input.value = today; });

            // [3] 로그인 세션 체크
            if(sessionStorage.getItem('isLoggedIn') === 'true') {
                // 만료되지 않았을 때만 자동 로그인 허용
                if(!isExpired()) {
                    document.getElementById('login-overlay').style.display = 'none';
                    document.getElementById('main-app').style.filter = 'none';
                }
            }
        });

        // --- 사용 기한 체크 함수 (새로 추가됨) ---
        function isExpired() {
            const expireDate = new Date("2026-03-01T00:00:00"); // 2026년 3월 1일 0시부터 차단 (즉, 2월 28일까지 사용 가능)------------------------>
            const now = new Date();
            return now >= expireDate;
        }

        function checkExpiration() {
            if (isExpired()) {
                // 만료된 경우: 입력창과 버튼 비활성화 및 메시지 출력
                const input = document.getElementById('login-pw');
                const btn = document.querySelector('.login-btn');
                const error = document.getElementById('login-error');

                input.disabled = true;
                input.placeholder = "사용 기한이 만료되었습니다.";
                btn.disabled = true;
                btn.style.background = "#555"; // 회색으로 변경
                btn.innerText = "만료됨 (Expired)";
                
                error.style.display = 'block';
                error.style.color = 'var(--danger)';
                error.innerHTML = "⛔ 본 소프트웨어의 사용 기한은<br>2026년 2월 28일까지입니다.";
                
                // 로그인 시도 함수(tryLogin) 무력화
                window.tryLogin = function() { alert("사용 기한이 만료되었습니다."); };
            }
        }
        document.addEventListener('contextmenu', event => event.preventDefault()); // 우클릭 방지

        document.onkeydown = function(e) {
            // F12 (개발자 도구) 방지
            if(e.keyCode == 123) {
                return false;
            }
            // Ctrl+Shift+I (개발자 도구) 방지
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
                return false;
            }
            // Ctrl+Shift+C (요소 검사) 방지
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) {
                return false;
            }
            // Ctrl+Shift+J (콘솔) 방지
            if(e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
                return false;
            }
            // Ctrl+U (소스 보기) 방지
            if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
                return false;
            }
        }

        // 이미지 드래그 방지
        document.ondragstart = function() { return false; }; 
        
        // 선택 방지 (텍스트 긁기 방지 - 필요 시 주석 처리)
        // document.onselectstart = function() { return false; }; 

    </script>
</body>
</html>
